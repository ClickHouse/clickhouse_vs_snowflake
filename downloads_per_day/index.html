<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ClickHouse vs Snowflake - Downloads per Day</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="icon" href="data:image/gif;base64,R0lGODlhIAAgAOMPAHMUEmkyHOcbF8UvJts/E3BeOih1YziiQmebLt2AFjeyQKqZKNWPjLybfPfcDP///yH5BAEKAA8ALAAAAAAgACAAAATg8MlJ6ws26z0EGcQmZgAhnN6oPg0wDA0zrGMTAADDxEJCZ4Gba8c4hX4Uw+XWeYGOyMdhgkuYrAToqIBQHBCIKQ6wcJhPyINarUBcyuYE+ndQeOsKuNlxmv3CdnZfew5yAlEPC12BhFhZiBJ2CI1GkBMHeoV9PpYPhIUDBqIFnZ8EBaKplqYMqaqIewl8A6iupFF7C1YCoaJqq4UOWQIBBmtTuIQmWWxekJQeYWuWcFYPfl+dLAELOxML2hIYDeEWt7flEufknTZB7+8NBeyINxjqDwU4QYg26BTu6KVTEQEAOw==">
    <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">

    <style>
        :root {
            --color: black;
            --title-color: black;
            --background-color: white;

            --link-color: #08F;
            --link-hover-color: #F40;

            --selector-text-color: black;
            --selector-active-text-color: black;
            --selector-background-color: #EEE;
            --selector-active-background-color: #FFCB80;
            --selector-hover-text-color: black;
            --selector-hover-background-color: #FDB;

            --summary-every-other-row-color: #F8F8F8;
            --highlight-color: #EEE;
            --bar-color: #FFCB80;

            --tooltip-text-color: white;
            --tooltip-background-color: black;

            --nothing-selected-color: #CCC;
            --shadow-color: grey;
        }

        [data-theme="dark"] {
            --color: #CCC;
            --title-color: white;
            --background-color: #04293A;

            --link-color: #8CF;
            --link-hover-color: #FFF;

            --selector-text-color: white;
            --selector-background-color: #444;
            --selector-active-text-color: white;
            --selector-active-background-color: #088;
            --selector-hover-text-color: black;
            --selector-hover-background-color: white;

            --summary-every-other-row-color: #042e41;
            --highlight-color: #064663;
            --bar-color: #088;

            --tooltip-text-color: white;
            --tooltip-background-color: #444;

            --nothing-selected-color: #666;
            --shadow-color: black;
        }

        html, body {
            color: var(--color);
            background-color: var(--background-color);
            width: 100%;
            height: 100%;
            margin: 0;
            overflow: auto;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            padding: 1% 3% 0 3%;
        }

        h1 {
            color: var(--title-color);
        }

        table {
             border-spacing: 1px;
        }

        .stick-left {
            position: sticky;
            left: 0px;
        }

        .selectors-container {
            padding: 2rem 0 2rem 0;
            user-select: none;
        }

        .selectors-container th {
            text-align: left;
            vertical-align: top;
            white-space: nowrap;
            padding-top: 0.5rem;
            padding-right: 1rem;
        }

        .selector {
            display: inline-block;
            margin-left: 0.1rem;
            padding: 0.2rem 0.5rem 0.2rem 0.5rem;
            background: var(--selector-background-color);
            color: var(--selector-text-color);
            border: 0.2rem solid var(--background-color);
            border-radius: 0.5rem;
        }

        .selector-active {
            color: var(--selector-active-text-color);
            background: var(--selector-active-background-color);
        }

        a, a:visited {
            text-decoration: none;
            color: var(--link-color);
            cursor: pointer;
        }

        a:hover {
            color: var(--link-hover-color);
        }

        .selector:hover {
            color: var(--selector-hover-text-color) !important;
            background: var(--selector-background-color);
        }

        .selector-active:hover {
            background: var(--selector-hover-background-color);
        }

        #summary tr:nth-child(odd) {
            background: var(--summary-every-other-row-color);
        }

        .summary-name {
            white-space: nowrap;
            text-align: right;
            padding-right: 1rem;
        }

        .summary-bar-cell {
            width: 100%;
        }

        .summary-bar {
            height: 1rem;
            background: var(--bar-color);
            border-radius: 0 0.2rem 0.2rem 0;
        }

        .summary-number {
            font-family: monospace;
            text-align: right;
            padding-left: 1rem;
            white-space: nowrap;
        }

        th {
            padding-bottom: 0.5rem;
        }

        .th-entry-hilite {
            background: var(--highlight-color);
            font-weight: bold;
        }

        .summary-row:hover, .summary-row-hilite {
            background: var(--highlight-color) !important;
            font-weight: bold;
        }

        #details {
            padding-bottom: 1rem;
        }

        #details th {
            vertical-align: bottom;
            white-space: pre;
        }

        #details td {
            white-space: pre;
            font-family: monospace;
            text-align: right;
            padding: 0.1rem 0.5rem 0.1rem 0.5rem;
        }

        .shadow:hover {
            box-shadow: 0 0 1rem var(--shadow-color);
            position: relative;
        }

        #nothing-selected {
            display: none;
            font-size: 32pt;
            font-weight: bold;
            color: var(--nothing-selected-color);
        }

        .note {
            position: relative;
            display: inline-block;
        }

        .tooltip {
            position: absolute;
            bottom: calc(100% + 0.5rem);
            visibility: hidden;
            background-color: var(--tooltip-background-color);
            color: var(--tooltip-text-color);
            box-shadow: 0 0 1rem var(--shadow-color);
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            z-index: 1;
            text-align: left;
            white-space: normal;
        }

        .tooltip-result {
            left: calc(50% - 0.25rem);
            width: 20rem;
            margin-left: -10rem;
        }

        .tooltip-query {
            left: 0;
            width: 40rem;
            margin-left: -3rem;
        }

        .note:hover .tooltip {
            visibility: visible;
        }

        .tooltip::after {
            content: " ";
            position: absolute;
            top: 100%;
            border-width: 0.5rem;
            border-style: solid;
            border-color: var(--tooltip-background-color) transparent transparent transparent;
        }

        .tooltip-result::after {
            left: 50%;
            margin-left: -1rem;
        }

        .tooltip-query::after {
            left: 3rem;
            margin-left: 0.5rem;
        }

        .nowrap {
            text-wrap: none;
        }

        .themes {
            float: right;
            font-size: 200%;
            cursor: pointer;
        }

        #toggle-dark, #toggle-light {
            padding-right: 0.5rem;
            cursor: pointer;
        }

        #toggle-dark:hover, #toggle-light:hover {
            display: inline-block;
            transform: translate(1px, 1px);
            filter: brightness(125%);
        }
    </style>
    <script type="text/javascript">

const data = [
{"system":"ClickHouse","date":"2023-06-28","machine":"720_GB","config":"default","comment":"","tags":["Cloud"],"data_size":991638026556,"result":[[1.937,1.516,1.562],[1.256,0.684,0.387],[1.024,0.672,0.857],[1.23,0.705,0.318],[1.859,0.612,0.622],[0.991,0.501,0.119],[0.984,0.619,1.137],[0.71,0.426,0.686],[1.144,1.06,1.145],[0.605,0.154,0.145],[1.932,0.644,1.021],[0.437,0.735,0.109],[1.185,0.79,0.605],[0.906,0.488,0.482],[0.785,0.961,0.467],[0.556,0.455,0.462],[0.7,1.323,0.603],[0.677,0.278,0.655],[0.684,0.409,0.753],[0.791,0.547,0.258],[0.966,0.532,1.013],[1.321,0.789,0.101],[0.991,0.92,0.561],[0.407,0.264,0.06],[0.74,0.348,0.78],[0.553,0.228,0.21],[1.192,0.712,0.496],[0.973,0.522,0.911],[0.874,1.015,0.976],[0.557,0.314,0.116],[0.83,0.535,0.394],[0.948,0.543,0.333],[1.078,0.427,0.767],[0.774,0.715,0.309],[0.998,0.933,0.349],[0.56,0.394,0.592],[0.673,0.75,0.353],[0.615,0.609,0.157],[0.643,0.31,0.734],[0.886,0.46,0.228],[0.801,0.77,0.842],[0.559,0.566,0.402],[0.706,0.732,0.728],[0.433,0.311,0.37],[0.615,0.693,0.305],[0.789,0.419,0.462],[0.731,0.34,0.539],[1.454,0.591,0.197],[1.064,0.323,0.65],[0.682,0.689,0.089],[0.58,0.288,0.75],[0.541,0.337,0.056],[0.835,0.305,0.54],[0.853,0.185,0.593],[0.379,0.5,0.235],[0.84,0.771,0.41],[0.691,0.921,0.291],[0.949,0.572,0.049],[0.47,0.248,0.512],[0.343,0.316,0.072],[0.636,0.272,0.623],[0.511,0.577,0.065],[0.881,0.748,0.581],[0.973,0.494,0.144],[0.491,0.562,0.5],[0.386,0.4,0.06],[0.52,0.534,0.376],[0.636,0.45,0.61],[0.732,0.722,0.338],[0.703,0.356,0.3],[0.592,0.283,0.283],[0.475,0.514,0.381],[0.847,1.122,1.017],[1.117,0.806,0.742],[0.617,0.29,0.304],[0.387,0.284,0.053],[0.76,0.56,0.69],[0.412,0.338,0.316],[0.653,0.655,0.344],[0.295,0.324,0.058],[0.523,0.448,0.779],[0.707,0.076,0.077],[1.043,1.02,0.255],[0.938,0.207,0.211],[0.472,0.647,0.542],[0.76,0.487,0.072],[0.551,0.495,0.7],[0.695,0.564,0.176],[0.858,0.639,0.569],[0.392,0.095,0.327],[0.613,0.367,0.435],[0.349,0.383,0.31],[0.517,0.415,0.4],[0.591,0.139,0.053],[0.495,0.605,0.244],[0.689,0.322,0.098],[0.439,0.558,0.252],[0.549,0.075,0.29],[1.37,0.456,0.24],[0.536,0.131,0.548],[0.643,0.526,0.45],[0.412,0.354,0.076],[0.603,0.529,0.238],[0.621,0.354,0.047],[0.636,0.436,0.229],[0.627,0.285,0.068],[0.465,0.4,0.196],[0.392,0.446,0.052],[0.516,0.461,0.567],[0.643,0.413,0.104],[0.566,0.492,0.224],[0.75,0.192,0.492],[0.664,0.734,0.236],[1.123,0.122,0.437],[0.549,0.605,0.195],[0.602,0.406,0.042],[0.718,0.191,0.528],[0.704,0.188,0.951],[0.414,0.541,0.401],[0.65,0.258,0.06],[0.339,0.188,0.193],[0.59,0.891,0.158],[0.654,0.227,0.22],[1.037,0.511,0.566],[0.515,0.38,0.24],[0.37,0.402,0.266],[0.466,0.201,0.6],[0.621,0.558,0.197],[0.574,0.714,0.181],[0.745,0.531,0.102],[0.49,0.183,0.421],[1.015,0.696,0.289],[0.456,0.519,0.653],[0.594,0.312,0.09],[0.628,0.507,0.557],[0.737,1.656,0.138],[0.44,0.172,0.438],[1.115,0.536,0.173],[0.43,0.466,0.478],[0.777,0.41,0.15],[0.568,0.195,0.185],[0.704,0.608,0.146],[0.586,0.394,0.219],[0.529,0.524,0.428],[0.359,0.425,0.225],[0.715,0.046,0.227],[0.412,0.535,0.531],[0.804,0.352,0.166],[0.514,0.839,0.676],[0.623,0.563,0.578],[0.771,0.676,0.485],[1.024,0.503,0.06],[0.368,0.506,0.167],[0.52,0.335,0.455],[0.369,0.426,0.534],[0.43,0.418,0.219],[0.549,0.166,0.356],[0.508,0.335,0.097],[0.425,0.404,0.216],[0.578,0.19,0.053],[0.44,0.451,0.193],[0.51,0.059,0.222],[0.597,0.538,0.453],[0.678,0.111,0.434],[0.537,0.536,0.531],[0.525,0.124,0.397],[0.412,0.355,0.198],[0.732,0.476,0.411],[0.376,0.408,0.179],[0.437,0.645,0.109],[0.504,0.495,0.179],[0.587,0.466,0.098],[0.41,0.165,0.165],[0.711,0.118,0.123],[0.332,0.343,0.405],[0.507,0.033,0.043],[0.665,0.627,0.207],[0.938,1.074,0.131],[0.432,0.492,0.616],[0.539,0.317,0.091],[0.462,0.381,0.18],[0.684,0.599,0.256],[0.395,0.454,0.202],[0.672,0.027,0.263],[0.408,0.186,0.18],[0.424,0.335,0.063],[0.378,0.468,0.365],[0.738,0.045,0.444],[0.497,0.463,0.181],[0.507,0.349,0.045],[0.436,0.536,0.163],[0.966,0.48,0.34],[0.449,0.143,0.35],[0.413,0.027,0.342],[0.365,0.181,0.365],[0.614,0.58,0.099],[0.582,0.437,0.176],[0.762,0.446,0.097],[0.878,0.362,0.359],[0.521,0.311,0.08]],"source":"downloads_per_day/results/clickhouse_720_GB_default.json"}
,{"system":"Snowflake","date":"2023-06-28","machine":"2XLARGE","config":"date_project_cluster","comment":"","tags":["Cloud"],"data_size":1467343154176,"result":[[3.407,2.85,3.033],[0.996,0.834,0.91],[1.757,1.242,2.843],[0.94,0.94,1.001],[2.562,1.493,1.887],[1.543,0.519,1.603],[1.571,1.453,1.785],[0.815,0.575,0.539],[2.977,1.322,1.55],[1.419,0.822,0.56],[2.789,1.375,1.38],[1.155,0.723,0.512],[1.95,1.129,1.441],[1.181,0.687,0.649],[1.472,1.57,0.998],[1.178,0.552,0.918],[1.527,1.033,1.004],[0.87,0.827,0.505],[2.536,1.943,1.187],[1.357,0.944,1.082],[1.639,1.269,1.278],[1.246,0.575,0.954],[1.898,1.405,1.602],[0.526,0.562,0.797],[1.903,1.036,1.076],[1.316,0.563,0.878],[3.715,0.996,1.391],[1.455,0.653,0.65],[3.202,1.943,2.659],[1.009,0.859,0.821],[1.773,0.896,0.896],[1.156,0.673,1.064],[1.471,0.937,1.184],[0.459,0.478,0.721],[2.055,0.929,0.824],[0.515,0.76,0.824],[1.517,1.493,1.417],[0.61,0.587,0.912],[4.71,0.763,1.178],[0.923,0.902,0.528],[1.709,1.263,1.283],[0.469,0.829,0.48],[3.556,1.408,1.264],[0.893,0.607,0.588],[1.923,1.119,0.782],[0.497,0.863,1.025],[1.981,1.021,0.974],[1.257,0.886,0.668],[2.639,1.39,1.29],[0.793,0.548,0.894],[1.838,1.317,0.859],[0.499,0.463,0.538],[2.239,2.307,1.281],[1.187,0.87,0.486],[1.439,0.987,1.212],[0.572,0.6,0.845],[4.952,1.112,1.12],[0.429,0.705,0.519],[1.606,1.107,1.071],[0.628,0.765,0.522],[1.868,1.401,2.289],[0.726,0.579,0.574],[2.035,1.039,0.779],[0.605,0.599,0.549],[1.819,1.104,1.248],[0.542,0.488,0.732],[1.603,0.757,0.701],[0.503,0.653,0.618],[1.638,1.117,1.104],[0.458,0.443,0.712],[2.174,1.215,1.352],[0.776,0.518,0.541],[1.41,1.039,0.718],[0.694,0.862,0.868],[2.056,0.693,0.702],[0.577,0.623,0.528],[1.447,0.714,1.114],[0.512,0.475,0.577],[1.551,1.28,0.854],[1.238,0.883,0.502],[1.706,1.928,1.948],[0.642,0.915,0.681],[1.802,0.747,0.708],[1.016,0.616,0.985],[1.548,1.977,1.433],[1.193,0.702,0.88],[3.886,0.769,0.653],[2.035,0.516,0.727],[2.386,0.972,0.686],[0.868,0.609,0.754],[1.752,0.559,0.626],[0.819,0.913,0.494],[2.018,0.753,0.681],[0.486,0.583,0.519],[1.72,0.779,0.762],[0.864,0.526,0.784],[1.715,1.062,0.618],[0.536,0.551,0.529],[1.507,0.891,0.656],[0.857,0.531,0.616],[1.798,1.867,1.708],[1.148,0.599,0.871],[1.432,0.862,1.096],[0.699,0.639,0.794],[1.73,0.742,0.712],[0.733,0.521,0.507],[1.461,1.145,1.171],[0.536,0.473,0.899],[7.628,0.647,1.075],[0.511,0.596,0.771],[1.272,1.539,0.571],[0.525,0.808,0.546],[1.499,1.258,1.015],[0.56,0.578,0.859],[3.512,1.085,0.733],[1.026,0.592,0.813],[1.494,0.642,1.07],[0.841,0.843,0.856],[1.676,1.032,0.694],[0.728,0.725,0.505],[1.451,0.59,1.027],[0.764,0.434,0.812],[1.889,1.055,1.018],[0.437,0.609,0.587],[0.79,0.627,0.64],[0.741,0.784,0.524],[1.798,0.694,1.034],[0.573,0.53,0.841],[1.799,0.744,0.594],[0.789,0.55,0.597],[1.447,0.742,0.975],[0.473,0.926,0.565],[1.687,1.68,1.16],[0.619,0.568,0.768],[1.549,1.193,0.652],[0.902,0.774,0.54],[2.294,0.609,0.723],[0.565,0.496,0.681],[1.432,1.059,0.988],[1.036,0.852,0.83],[0.777,1.07,1.034],[0.669,0.49,0.865],[1.334,0.728,0.742],[0.737,0.87,0.631],[2.862,0.902,1.013],[0.485,0.929,0.77],[1.317,1.052,0.831],[0.535,0.777,0.559],[1.35,0.545,0.649],[0.648,0.86,0.832],[2.437,1.851,1.887],[0.989,0.78,0.533],[1.619,0.814,0.665],[0.777,0.578,0.8],[1.304,0.578,0.946],[0.89,0.803,0.449],[1.982,0.929,0.928],[0.868,0.98,0.531],[1.897,0.945,0.6],[0.832,0.476,0.538],[1.917,0.65,0.716],[0.491,0.853,0.655],[1.695,0.533,0.585],[0.822,0.787,0.514],[1.649,0.954,1.101],[0.528,0.529,0.777],[1.075,0.849,1.094],[1.374,0.495,0.897],[1.851,0.554,1.012],[0.905,0.527,0.884],[1.72,0.951,0.969],[0.491,0.831,0.514],[4.56,0.556,0.552],[0.496,0.486,0.48],[1.514,1.024,0.987],[0.443,0.418,0.674],[1.697,1.211,0.632],[0.788,0.568,0.793],[1.214,0.523,0.963],[0.792,0.794,0.5],[1.634,0.63,0.609],[0.441,0.715,0.508],[1.635,0.942,0.731],[0.68,0.741,0.544],[1.805,0.974,0.63],[0.525,0.464,0.532],[2.126,1.726,1.258],[0.953,0.759,0.548],[1.659,1.591,1.526],[1.166,0.739,0.492],[1.293,1.116,1.825],[1.207,0.864,0.457],[1.749,0.905,0.608],[0.58,0.402,0.517],[2.092,0.982,0.63],[0.494,0.742,0.503],[1.535,1.232,1.485],[1.614,1.229,0.61],[1.287,1.008,0.904],[0.468,0.585,0.834]],"source":"downloads_per_day/results/snowflake_2XLARGE_date_project_cluster.json"}
,{"system":"Snowflake","date":"2023-06-27","machine":"2XLARGE","config":"default","comment":"","tags":["Cloud"],"data_size":2186843044352,"result":[[31.449,12.46,9.73],[18.423,12.493,8.292],[9,8.785,8.673],[8.222,7.883,7.547],[8.597,8.554,8.659],[8.134,7.762,7.654],[8.746,8.623,9.04],[8.21,8,8.043],[7.911,7.789,7.989],[7.703,7.514,7.893],[8.463,7.701,8.324],[8.131,7.919,7.856],[8.221,7.975,8.267],[7.665,7.937,7.85],[7.978,8.197,8.386],[8.119,7.784,8.424],[8.877,8.663,8.587],[8.115,7.53,8.983],[7.593,8.285,8.022],[7.575,7.84,7.593],[8.628,8.041,7.771],[7.936,7.642,7.621],[7.839,8.361,8.327],[7.791,7.509,7.281],[7.885,8.545,8.003],[8.055,7.946,7.528],[7.652,8.675,8.312],[8.347,8.795,8.201],[8.231,7.673,7.775],[8.022,7.898,8.156],[8.373,8.44,7.949],[8.253,7.962,7.624],[7.803,7.944,8.038],[7.956,7.56,8.168],[7.804,8.401,7.846],[7.678,7.333,8.28],[8.502,8.076,8.305],[7.877,7.944,8.141],[7.962,8.087,7.816],[7.613,7.892,7.423],[8.038,7.997,7.98],[7.776,7.724,7.93],[8.024,7.99,7.96],[7.791,7.582,7.663],[8.025,8.072,7.977],[7.666,7.541,7.822],[8.319,8.049,7.964],[7.385,7.881,7.809],[8.101,8.265,7.722],[7.921,7.447,7.627],[7.928,8.009,8.019],[7.871,7.478,7.634],[8.003,8.765,8.036],[7.874,8.02,7.982],[8.136,8.426,7.764],[7.557,7.703,7.772],[7.848,8.202,7.977],[7.792,7.74,7.669],[7.862,7.927,8.102],[7.829,7.959,7.367],[8.227,8.035,8.195],[8.202,7.997,8.015],[8.278,8.03,7.977],[7.842,7.822,7.818],[8.015,8.367,7.981],[8.473,8.192,8.223],[8.063,8.63,7.89],[8.692,8.553,7.87],[8.237,8.147,8.393],[7.87,8.34,8.109],[8.143,9.032,8.539],[7.82,8.084,7.933],[8.329,8.133,8.291],[7.479,7.484,7.539],[8.275,8.168,8.161],[7.961,7.266,8.032],[8.138,8.221,7.919],[8.07,7.514,7.79],[7.593,7.729,7.629],[9.015,7.399,7.764],[7.786,7.696,7.813],[7.318,7.655,7.354],[7.908,8.078,7.853],[7.902,7.433,7.99],[7.697,7.855,7.73],[7.655,7.731,7.647],[7.655,8.022,7.85],[8.075,7.99,7.941],[7.943,8.344,8.289],[7.541,7.803,7.74],[7.98,7.38,7.861],[7.936,7.871,7.751],[7.744,8.042,7.988],[7.236,7.582,7.735],[7.351,7.691,7.753],[7.533,7.607,7.811],[7.933,7.965,7.908],[7.981,8.233,7.749],[8.405,7.812,7.862],[7.633,7.951,7.749],[7.397,7.756,8.126],[7.491,7.624,7.783],[7.978,7.808,7.963],[7.772,7.754,8.78],[8.669,8.319,9.783],[7.727,7.454,7.886],[7.473,8.156,8.039],[8.133,7.677,7.588],[7.905,8.219,7.944],[7.893,7.519,7.633],[8.471,7.63,7.551],[7.712,7.49,7.525],[7.568,7.644,8.454],[7.542,7.448,7.471],[8.135,8.369,7.892],[7.651,8.52,7.795],[7.842,8.576,8.267],[7.379,7.875,7.949],[7.877,7.83,8.494],[7.814,7.607,7.826],[7.759,7.89,7.864],[7.691,7.752,7.733],[7.992,7.677,7.417],[7.753,7.431,7.713],[7.726,8.241,7.846],[7.584,7.801,7.496],[7.742,7.836,7.504],[7.712,7.688,7.779],[7.432,8.373,20.387],[7.872,7.75,7.547],[8.49,7.919,8.003],[7.923,8.59,7.932],[7.569,8.004,7.76],[7.802,7.662,8.58],[8.031,7.84,7.665],[7.405,7.974,7.588],[7.833,7.657,7.885],[7.733,7.679,7.679],[7.954,7.97,7.967],[7.904,7.611,7.881],[8.647,8.4,7.945],[7.781,7.882,7.695],[8.012,7.454,7.873],[7.95,7.902,7.896],[9.035,8.116,7.874],[7.756,7.711,7.694],[7.797,7.685,8.232],[8.185,7.686,7.683],[8.091,7.792,7.703],[7.964,7.707,7.856],[7.45,8.761,7.518],[7.6,7.567,8.2],[7.647,7.928,7.855],[7.672,7.83,7.769],[8.61,7.97,8.207],[7.977,7.554,8.77],[8.27,7.669,7.781],[7.611,7.712,7.803],[7.788,7.916,7.827],[7.593,7.573,7.748],[7.713,7.869,7.796],[7.905,7.717,8.007],[7.695,7.808,7.745],[7.744,7.527,7.73],[7.846,7.851,7.755],[7.711,7.783,7.83],[7.738,7.444,7.64],[7.472,7.712,7.594],[7.455,7.889,7.797],[8.172,7.862,7.857],[7.7,7.802,8.135],[7.943,7.713,7.627],[7.926,8.178,7.927],[7.717,7.774,7.707],[7.904,7.438,7.729],[7.547,7.679,7.612],[7.779,7.632,7.848],[7.684,7.67,7.758],[7.477,7.7,7.723],[7.625,7.874,7.562],[7.619,7.461,7.577],[7.944,7.576,7.745],[8.435,7.546,7.425],[7.054,7.403,7.444],[7.926,7.867,7.774],[7.527,7.731,7.746],[7.732,7.227,7.518],[7.333,7.294,7.447],[7.864,7.656,8.475],[8.144,7.549,8.176],[7.54,7.581,7.367],[7.438,7.432,7.262],[7.124,7.521,7.51],[7.263,7.408,7.455],[7.711,7.76,7.61],[7.809,7.89,7.777],[7.388,7.203,7.374],[7.449,7.567,7.394],[7.513,7.595,7.49],[7.711,7.882,7.441]],"source":"downloads_per_day/results/snowflake_2XLARGE_default.json"}
,{"system":"Snowflake","date":"2023-06-27","machine":"2XLARGE","config":"project_cluster","comment":"","tags":["Cloud"],"data_size":1676739812352,"result":[[2.669,2.291,1.609],[0.928,1.394,1.162],[1.029,1.11,1.868],[1.018,0.779,0.719],[2.133,1.495,1.909],[1.719,0.717,1.06],[2.358,1.279,1.24],[1.441,1.594,1.141],[1.916,1.393,0.973],[0.699,0.57,0.577],[2.124,1.446,1.653],[1.321,0.518,0.667],[1.617,0.927,1.511],[0.527,1,0.553],[1.872,1.104,0.89],[0.501,0.535,0.695],[1.908,1.472,1.787],[0.954,0.608,1.04],[2.649,1.293,1.668],[1.194,1.119,1.554],[1.452,1.395,1.025],[0.547,0.705,0.89],[2.023,1.395,0.983],[0.524,0.909,0.863],[1.419,1.293,1.288],[1.021,0.611,0.551],[1.963,0.982,1.227],[0.714,1.024,0.77],[2.889,1.535,2.115],[1.814,1.278,1.033],[1.916,1.202,1.623],[0.578,0.65,0.941],[1.967,0.832,0.843],[0.842,0.813,0.734],[1.558,1.368,1.13],[0.564,0.557,0.997],[1.884,0.773,1.135],[0.501,0.928,0.478],[1.836,1.086,1.116],[0.612,0.718,0.853],[1.814,1.081,0.733],[0.457,0.827,0.685],[1.656,1.057,0.687],[0.595,0.884,0.918],[1.575,0.741,0.783],[0.816,0.802,0.829],[1.483,0.675,1.093],[0.894,0.514,0.544],[1.49,1.135,0.824],[0.526,0.863,0.848],[1.897,0.941,1.045],[0.548,0.577,0.553],[1.825,1.068,1.075],[0.582,1.031,1.069],[1.545,0.951,1.065],[1.276,0.732,0.58],[2.01,1.166,1.101],[0.53,0.412,0.455],[1.691,0.684,0.785],[0.789,0.533,0.798],[1.708,1.084,0.706],[0.748,0.538,0.547],[1.372,0.749,0.731],[0.455,0.451,0.837],[1.412,1.191,1.021],[0.529,0.623,0.785],[1.764,0.634,0.72],[0.463,0.947,0.511],[1.558,1.093,1.228],[0.849,0.574,0.773],[2.213,0.756,0.647],[0.859,0.871,0.535],[1.41,0.983,0.955],[0.581,0.558,0.563],[1.511,0.956,0.555],[0.895,0.542,0.806],[1.454,0.63,1.056],[0.757,0.53,0.501],[1.329,0.645,1.148],[0.632,0.577,0.515],[0.992,1.153,1.426],[1.009,0.831,1.312],[1.879,0.639,0.614],[0.883,0.819,0.819],[1.4,1.367,1.015],[1.331,1.227,0.842],[1.404,1.09,0.79],[0.852,0.582,0.44],[1.493,0.647,0.6],[0.516,0.516,0.745],[1.107,0.796,0.519],[0.543,0.799,0.742],[1.386,0.631,1.046],[0.78,0.524,0.498],[1.554,0.974,0.569],[0.672,0.762,0.757],[1.269,0.935,0.55],[1.011,0.816,0.774],[2.23,0.568,0.698],[0.87,0.838,0.623],[1.251,0.777,1.577],[1.379,1.32,0.701],[1.622,0.995,1.089],[0.485,0.53,0.897],[2.686,0.702,1.135],[0.76,0.776,0.527],[1.729,1.013,0.609],[0.524,0.522,0.944],[1.275,0.854,0.585],[0.826,0.557,0.509],[5.313,0.999,1.05],[0.573,0.551,0.514],[1.409,0.933,1.029],[0.857,0.558,0.856],[1.98,0.6,0.673],[0.938,0.586,0.62],[1.354,0.916,0.643],[0.594,0.557,0.841],[1.36,0.637,0.908],[1.024,0.583,0.51],[1.599,0.994,0.969],[0.693,0.443,0.791],[2.433,0.927,0.567],[0.699,0.867,0.538],[0.721,1.111,1.011],[1.048,0.736,0.897],[1.591,0.66,0.655],[0.542,0.468,0.816],[1.527,0.652,1.005],[0.839,0.853,0.483],[1.921,0.984,0.907],[0.51,0.603,0.891],[1.625,0.726,1.036],[0.866,1.142,0.903],[1.681,0.564,0.901],[0.538,0.525,0.575],[1.718,0.882,0.684],[0.668,0.785,0.839],[1.551,0.5,0.574],[0.614,0.575,0.705],[0.619,1.071,0.985],[0.659,0.523,1.027],[1.526,0.658,0.61],[0.553,0.827,0.601],[1.339,1.034,0.9],[0.52,0.704,0.877],[1.888,0.802,0.546],[0.533,0.819,0.909],[1.222,0.688,0.992],[0.989,0.548,0.431],[3.63,3.506,1.231],[1.245,1.59,1.555],[1.147,0.89,0.612],[0.811,0.544,1.03],[1.507,0.965,0.86],[0.515,0.81,0.845],[1.355,0.521,0.492],[0.95,0.807,0.6],[1.316,0.91,0.909],[0.827,0.607,0.599],[1.344,1.029,0.564],[0.556,0.782,0.799],[1.288,0.542,1.011],[0.577,0.961,0.526],[1.232,0.92,0.898],[0.556,0.585,0.776],[1.072,0.572,0.618],[0.467,0.935,0.865],[1.235,0.549,0.764],[0.757,0.879,0.526],[1.692,0.878,0.61],[0.813,0.494,0.812],[1.544,0.498,0.607],[0.863,0.527,0.568],[1.102,0.929,0.951],[0.747,0.839,0.589],[1.568,0.964,0.572],[0.797,0.824,0.934],[1.061,0.865,0.47],[0.536,0.647,0.616],[2.143,1.059,0.833],[0.491,0.885,0.838],[1.502,0.544,0.812],[0.917,0.58,0.516],[1.545,0.656,0.571],[0.613,0.501,0.78],[1.106,1.517,1.323],[1.253,1.446,0.938],[1.303,1.114,0.831],[0.726,0.996,1.069],[1.354,0.916,1.007],[1.273,1.259,1.224],[1.925,0.886,0.702],[0.891,0.548,0.843],[1.801,0.502,0.594],[0.583,0.771,0.56],[1.083,1.371,1.325],[0.881,1.462,1.329],[1.608,0.534,0.852],[0.862,0.893,0.498]],"source":"downloads_per_day/results/snowflake_2XLARGE_project_cluster.json"}
,{"system":"Snowflake","date":"2023-06-28","machine":"2XLARGE","config":"project_date_cluster","comment":"","tags":["Cloud"],"data_size":1944972168704,"result":[[6.628,4.16,3.375],[2.992,2.463,2.939],[3.435,1.853,2.605],[2.71,1.447,1.724],[6.215,1.957,1.849],[2.062,1.651,1.557],[2.71,1.884,1.456],[1.66,1.377,1.556],[5.138,2.228,1.932],[1.726,1.543,1.698],[3.656,1.765,2.036],[1.903,1.608,1.406],[4.479,1.844,1.596],[1.61,1.812,1.37],[1.881,1.951,1.754],[1.382,1.331,1.196],[2.122,1.975,2.166],[1.381,0.841,1.416],[3.265,2.651,2.019],[1.801,2.426,2.094],[2.951,1.771,1.842],[1.394,1.685,0.753],[2.797,1.573,1.593],[2.025,1.694,1.743],[2.681,1.87,1.862],[1.372,0.985,0.848],[1.836,1.524,1.061],[1.196,1.331,1.517],[4.587,2.683,2.138],[1.874,1.939,2.088],[2.201,1.94,1.336],[1.706,1.365,0.895],[2.641,1.657,1.356],[1.76,1.595,1.463],[2.77,1.522,1.869],[1.364,1.631,1.23],[2.725,1.777,1.765],[1.304,1.257,1.212],[2.461,1.822,1.358],[1.825,0.931,1.28],[3.248,1.694,1.465],[1.223,1.507,1.442],[1.806,1.57,1.291],[1.659,1.427,1.591],[2.128,1.333,1.375],[0.98,1.1,1.083],[1.171,1.436,1.578],[1.459,0.911,1.202],[3.117,2.001,1.393],[1.914,1.148,1.64],[1.405,1.307,1.481],[1.496,1.567,1.077],[2.086,1.454,1.095],[0.773,1.784,1.72],[1.303,1.388,1.286],[1.101,1.431,0.771],[1.765,1.254,1.274],[1.083,0.729,1.008],[0.903,1.754,1.289],[1.504,0.823,1.605],[1.159,1.269,2.429],[1.136,0.837,1.426],[2.843,1.513,1.25],[1.325,1.231,0.965],[1.403,1.533,1.709],[1.728,1.143,1.168],[1.04,1.324,1.362],[1.008,0.819,1.383],[2.685,1.955,1.265],[1.637,1.229,1.611],[1.199,1.333,1.257],[1.107,0.698,0.699],[4.849,3.987,1.378],[1.398,1.507,1.225],[1.238,1.406,1.389],[1.306,0.873,1.158],[2.276,1.581,1.303],[1.014,1.503,1.724],[1.824,1.174,1.44],[1.562,1.174,1.72],[2.554,2.021,2.348],[1.443,1.303,1.399],[2.597,1.99,1.42],[1.53,1.458,1.347],[2.482,2.093,2.298],[2.104,1.867,1.889],[1.658,1.323,1.479],[1.518,1.233,1.224],[2.969,1.655,1.263],[1.55,1.127,1.435],[1.128,1.997,1.167],[1.146,1.34,1.043],[1.642,0.762,1.138],[1.022,1.575,1.614],[1.82,1.934,1.45],[1.524,0.845,1.451],[1.172,0.912,1.43],[1.698,1.137,1.01],[2.553,2.301,1.766],[1.723,1.41,1.196],[1.858,1.165,1.56],[0.927,1.718,1.33],[1.964,1.482,1.596],[0.961,1.712,1.229],[1.124,1.354,0.834],[1.039,1.165,0.62],[1.503,1.558,0.851],[1.465,0.836,1.509],[1.674,1.194,1.006],[1.353,1.052,1.412],[1.632,1.112,1.424],[1.238,0.653,1.088],[1.491,1.61,1.186],[1.507,1.357,1.474],[1.524,0.737,1.202],[0.869,1.106,1.232],[0.854,1.19,1.307],[1.604,1.185,0.802],[0.904,1.209,1.065],[1.417,0.943,0.662],[0.939,1.223,1.177],[0.874,0.728,0.706],[2.105,1.596,1.442],[0.739,1.154,1.518],[0.878,1.094,0.849],[1.163,1.197,0.899],[0.831,0.952,0.837],[1.224,1.154,0.762],[2.165,1.789,1.826],[1.629,1.285,1.195],[0.838,1.108,0.766],[0.695,1.072,0.834],[1.302,1.132,0.928],[1.812,1.156,0.764],[1.902,1.304,1.959],[1.759,1.083,1.806],[1.151,1.098,1.244],[0.97,1.199,0.986],[1.317,1.212,1.226],[0.861,0.774,0.878],[1.6,0.863,1.49],[1.078,1.413,0.871],[1.62,1.186,0.856],[1.404,1.234,1.186],[1.263,1.688,1.202],[0.835,1.182,1.149],[1.223,0.875,0.781],[1.318,0.996,1.384],[1.497,1.146,1.056],[1.083,1.016,0.684],[4.915,2.386,2.304],[1.967,4.549,1.588],[1.153,1.307,0.74],[0.826,1.401,0.678],[0.942,1.295,1.555],[1.068,0.668,1.076],[1.301,0.788,1.207],[1.596,1.333,1.235],[1.068,1.55,0.833],[0.983,0.785,0.934],[1.492,1.193,1.462],[1.363,1.193,1.078],[0.847,0.771,1.399],[1.099,0.707,1.575],[0.759,1.248,1.772],[0.824,0.874,0.91],[1.314,1.251,1.289],[1.581,1.18,1.229],[1.483,1.162,0.776],[1.119,0.804,1.119],[0.913,1.25,0.891],[1.116,1.013,0.7],[0.785,0.819,0.963],[1.179,1.101,0.731],[1.62,1.605,1.003],[1.32,1.533,1.241],[1.384,1.157,1.674],[0.753,0.746,1.206],[0.794,1.219,1.251],[0.974,1.331,1.093],[0.759,1.152,0.969],[1.51,0.75,1.083],[1.251,1.062,0.967],[0.813,1.014,1.103],[1.222,1.15,1.19],[1.009,1.152,1.053],[1.624,1.538,1.849],[1.288,1.907,1.237],[1.116,1.042,1.277],[1.297,1.041,1.135],[1.501,1.86,1.811],[1.32,1.398,1.323],[0.76,1.237,1.197],[1.128,1.419,0.744],[1.13,1.16,1.277],[1.106,1.043,1.102],[1.818,1.86,1.89],[1.781,1.332,1.429],[1.058,1.217,1.238],[1.121,1.119,1.54]],"source":"downloads_per_day/results/snowflake_2XLARGE_project_date_cluster.json"}
,{"system":"Snowflake","date":"2023-06-28","machine":"2XLARGE","config":"project_timestamp_cluster","comment":"","tags":["Cloud"],"data_size":1152806367232,"result":[[3.709,2.423,2.836],[0.771,2.118,1.358],[2.012,1.135,1.031],[0.494,0.514,0.863],[1.636,1.504,0.995],[1.952,0.985,0.86],[3.086,1.029,1.995],[0.769,1.175,0.671],[1.541,1.344,0.994],[0.844,0.7,0.466],[1.67,1.313,1.471],[0.48,0.844,0.636],[1.162,1.389,1.003],[0.683,1.09,1.116],[1.29,0.868,2.031],[0.461,1.227,1.787],[1.728,0.887,0.975],[0.408,1.156,0.445],[2.438,1.119,1.057],[0.845,0.483,0.536],[1.68,0.893,0.806],[0.48,0.499,0.477],[1.518,0.892,1.188],[0.445,0.693,0.449],[1.406,1.314,1.072],[0.511,0.889,0.575],[1.549,0.714,0.733],[0.676,0.578,0.609],[2.075,1.452,1.103],[0.862,0.755,0.923],[1.148,1.112,0.852],[0.486,0.935,0.574],[1.077,1.109,1.109],[0.481,0.479,0.728],[1.514,1.132,1.116],[0.764,0.807,0.776],[1.119,1.34,1.041],[0.918,0.796,0.8],[0.943,1.129,0.705],[0.414,0.573,0.479],[1.204,0.69,0.742],[0.63,1.085,0.857],[1.253,0.703,1.098],[0.867,0.765,0.758],[1.106,1.095,0.683],[0.718,0.498,0.755],[1.157,1.099,1.026],[0.545,0.538,0.55],[1.012,0.892,0.72],[1.08,0.597,0.765],[1.322,1.114,0.944],[0.439,0.627,0.772],[1.558,1.102,1.043],[0.86,0.518,0.922],[0.948,0.687,1.051],[0.573,0.527,0.778],[1.61,0.738,0.66],[0.472,0.473,0.606],[1.435,1.154,1.046],[0.84,0.861,0.487],[1.415,0.679,0.671],[0.775,0.887,0.51],[1.111,1.046,0.748],[0.849,0.827,0.802],[1.027,0.795,0.639],[0.58,0.69,0.424],[1.323,0.664,0.99],[0.554,0.547,0.824],[1.109,0.949,0.571],[0.595,0.575,0.604],[1.061,1.066,1.125],[0.795,0.645,0.738],[1.348,0.627,0.582],[0.84,0.549,0.938],[0.851,1.139,1.106],[0.475,0.593,0.625],[1.516,0.614,0.979],[0.618,0.443,0.53],[1.594,1.081,0.652],[0.432,0.676,0.691],[1.118,1.578,1.94],[0.705,0.847,0.87],[1.082,0.994,1.006],[0.819,0.61,0.894],[1.107,1.649,0.959],[0.807,0.628,0.967],[1.12,0.973,0.611],[0.819,0.518,0.546],[1.439,1.059,1.216],[0.738,0.52,0.388],[1.361,0.956,0.815],[0.749,0.706,0.731],[1.01,0.974,0.62],[0.658,0.732,0.658],[0.916,0.511,0.558],[0.445,0.749,0.771],[1.112,0.619,0.645],[0.763,0.78,0.493],[1.489,0.662,0.963],[0.825,0.561,0.521],[1.149,0.843,1.008],[0.549,0.868,0.794],[1.54,0.937,0.687],[0.557,0.591,0.346],[2.281,0.987,0.508],[0.69,0.75,0.438],[1.262,0.768,0.688],[0.453,0.424,1.013],[1.04,0.912,0.696],[0.679,0.638,0.498],[1.785,0.666,0.983],[0.923,0.605,0.75],[1.291,0.954,0.598],[0.744,0.475,0.903],[1.127,0.513,0.913],[0.783,0.561,0.563],[1.44,0.886,0.548],[0.494,0.527,0.778],[1.073,0.543,0.934],[0.707,0.706,0.446],[1.084,1.01,0.598],[0.49,0.636,0.594],[1.412,0.5,0.955],[0.775,0.562,0.613],[0.727,1.072,0.562],[0.664,0.694,0.422],[1.065,0.956,0.487],[0.546,0.754,0.507],[1.599,0.959,0.889],[0.815,0.938,0.527],[1.41,0.925,0.681],[0.841,0.407,0.427],[3.547,1.046,0.566],[0.963,0.739,0.636],[1.552,0.555,0.861],[0.796,0.502,0.607],[1.41,0.871,0.52],[0.57,0.62,0.508],[1.934,1.006,0.625],[0.79,0.755,0.507],[0.907,1.043,0.57],[0.883,0.522,0.802],[1.096,0.59,0.496],[0.941,0.657,0.524],[1.297,0.846,0.636],[0.438,0.471,0.678],[0.955,0.973,0.933],[0.523,0.417,0.69],[1.001,0.957,0.536],[0.467,0.744,0.741],[2.366,1.378,1.336],[1.042,0.681,0.797],[1.623,0.964,0.741],[0.58,0.746,0.602],[0.929,0.619,0.585],[0.906,0.825,0.528],[1.365,0.77,0.492],[0.676,0.457,0.778],[1.701,0.905,0.949],[0.702,0.417,0.811],[1.151,0.945,0.763],[0.471,0.569,0.746],[1.071,0.713,0.751],[0.758,0.944,0.785],[1.714,4.008,3.115],[0.875,0.715,0.582],[0.53,0.946,0.644],[0.782,0.803,0.795],[1.122,0.883,0.514],[0.749,0.508,0.523],[1.397,0.839,0.942],[0.63,0.516,0.389],[1.411,0.889,0.505],[0.483,0.747,0.78],[1.021,1.118,0.867],[1.667,0.443,0.442],[1.483,0.93,0.913],[0.594,0.508,0.758],[1.448,0.988,0.494],[0.514,0.833,0.605],[1.588,0.914,0.538],[0.445,0.443,0.545],[1.409,0.868,0.873],[0.616,0.548,0.337],[1.366,0.859,0.482],[0.599,0.553,0.545],[1.426,1.079,1.016],[0.775,0.69,0.704],[1.061,1.015,0.829],[0.7,0.607,0.696],[1.373,1.255,1.023],[1.262,0.798,0.513],[1.128,0.51,0.906],[0.435,0.536,0.616],[1.534,0.894,0.873],[0.558,0.491,0.728],[1.086,0.786,1.045],[1.171,0.545,0.868],[1.52,0.885,0.444],[0.436,0.704,0.721]],"source":"downloads_per_day/results/snowflake_2XLARGE_project_timestamp_cluster.json"}
]; // end of data
const queries = [
"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'boto3' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 13824 second) as period, count() as count FROM pypi WHERE project = 'boto3' AND date >= '2023-06-23'::Date - toIntervalDay(25) AND date <= '2023-06-23'::Date - toIntervalDay(9) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(25) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(9) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'urllib3' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 25920 second) as period, count() as count FROM pypi WHERE project = 'urllib3' AND date >= '2023-06-23'::Date - toIntervalDay(41) AND date <= '2023-06-23'::Date - toIntervalDay(11) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(41) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(11) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'requests' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count FROM pypi WHERE project = 'requests' AND date >= '2023-06-23'::Date - toIntervalDay(59) AND date <= '2023-06-23'::Date - toIntervalDay(53) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(59) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(53) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'botocore' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 9504 second) as period, count() as count FROM pypi WHERE project = 'botocore' AND date >= '2023-06-23'::Date - toIntervalDay(17) AND date <= '2023-06-23'::Date - toIntervalDay(6) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(17) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'charset-normalizer' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 9504 second) as period, count() as count FROM pypi WHERE project = 'charset-normalizer' AND date >= '2023-06-23'::Date - toIntervalDay(21) AND date <= '2023-06-23'::Date - toIntervalDay(10) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(21) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(10) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'setuptools' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6048 second) as period, count() as count FROM pypi WHERE project = 'setuptools' AND date >= '2023-06-23'::Date - toIntervalDay(78) AND date <= '2023-06-23'::Date - toIntervalDay(71) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(78) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(71) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'idna' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 52704 second) as period, count() as count FROM pypi WHERE project = 'idna' AND date >= '2023-06-23'::Date - toIntervalDay(61) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(61) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'certifi' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 12096 second) as period, count() as count FROM pypi WHERE project = 'certifi' AND date >= '2023-06-23'::Date - toIntervalDay(15) AND date <= '2023-06-23'::Date - toIntervalDay(1) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(15) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 's3transfer' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 25920 second) as period, count() as count FROM pypi WHERE project = 's3transfer' AND date >= '2023-06-23'::Date - toIntervalDay(66) AND date <= '2023-06-23'::Date - toIntervalDay(36) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(66) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(36) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'python-dateutil' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 26784 second) as period, count() as count FROM pypi WHERE project = 'python-dateutil' AND date >= '2023-06-23'::Date - toIntervalDay(54) AND date <= '2023-06-23'::Date - toIntervalDay(23) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(54) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(23) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'awscli' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 12960 second) as period, count() as count FROM pypi WHERE project = 'awscli' AND date >= '2023-06-23'::Date - toIntervalDay(71) AND date <= '2023-06-23'::Date - toIntervalDay(56) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(71) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(56) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'typing-extensions' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count FROM pypi WHERE project = 'typing-extensions' AND date >= '2023-06-23'::Date - toIntervalDay(2) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(2) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'six' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 21600 second) as period, count() as count FROM pypi WHERE project = 'six' AND date >= '2023-06-23'::Date - toIntervalDay(35) AND date <= '2023-06-23'::Date - toIntervalDay(10) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(35) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(10) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pyyaml' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 70848 second) as period, count() as count FROM pypi WHERE project = 'pyyaml' AND date >= '2023-06-23'::Date - toIntervalDay(89) AND date <= '2023-06-23'::Date - toIntervalDay(7) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(89) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(7) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'google-api-core' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6048 second) as period, count() as count FROM pypi WHERE project = 'google-api-core' AND date >= '2023-06-23'::Date - toIntervalDay(25) AND date <= '2023-06-23'::Date - toIntervalDay(18) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(25) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(18) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'wheel' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 45792 second) as period, count() as count FROM pypi WHERE project = 'wheel' AND date >= '2023-06-23'::Date - toIntervalDay(66) AND date <= '2023-06-23'::Date - toIntervalDay(13) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(66) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(13) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'cryptography' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count FROM pypi WHERE project = 'cryptography' AND date >= '2023-06-23'::Date - toIntervalDay(4) AND date <= '2023-06-23'::Date - toIntervalDay(1) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(4) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'packaging' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6048 second) as period, count() as count FROM pypi WHERE project = 'packaging' AND date >= '2023-06-23'::Date - toIntervalDay(8) AND date <= '2023-06-23'::Date - toIntervalDay(1) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(8) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'numpy' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 19008 second) as period, count() as count FROM pypi WHERE project = 'numpy' AND date >= '2023-06-23'::Date - toIntervalDay(23) AND date <= '2023-06-23'::Date - toIntervalDay(1) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(23) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pip' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 32832 second) as period, count() as count FROM pypi WHERE project = 'pip' AND date >= '2023-06-23'::Date - toIntervalDay(84) AND date <= '2023-06-23'::Date - toIntervalDay(46) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(84) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(46) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'jmespath' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 16416 second) as period, count() as count FROM pypi WHERE project = 'jmespath' AND date >= '2023-06-23'::Date - toIntervalDay(42) AND date <= '2023-06-23'::Date - toIntervalDay(23) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(42) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(23) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'importlib-metadata' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 7776 second) as period, count() as count FROM pypi WHERE project = 'importlib-metadata' AND date >= '2023-06-23'::Date - toIntervalDay(10) AND date <= '2023-06-23'::Date - toIntervalDay(1) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(10) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'zipp' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count FROM pypi WHERE project = 'zipp' AND date >= '2023-06-23'::Date - toIntervalDay(12) AND date <= '2023-06-23'::Date - toIntervalDay(6) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(12) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'click' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 29376 second) as period, count() as count FROM pypi WHERE project = 'click' AND date >= '2023-06-23'::Date - toIntervalDay(53) AND date <= '2023-06-23'::Date - toIntervalDay(19) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(53) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(19) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pyasn1' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 8640 second) as period, count() as count FROM pypi WHERE project = 'pyasn1' AND date >= '2023-06-23'::Date - toIntervalDay(89) AND date <= '2023-06-23'::Date - toIntervalDay(79) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(89) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(79) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'colorama' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count FROM pypi WHERE project = 'colorama' AND date >= '2023-06-23'::Date - toIntervalDay(6) AND date <= '2023-06-23'::Date - toIntervalDay(3) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(3) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'protobuf' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 25056 second) as period, count() as count FROM pypi WHERE project = 'protobuf' AND date >= '2023-06-23'::Date - toIntervalDay(35) AND date <= '2023-06-23'::Date - toIntervalDay(6) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(35) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'rsa' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 32832 second) as period, count() as count FROM pypi WHERE project = 'rsa' AND date >= '2023-06-23'::Date - toIntervalDay(74) AND date <= '2023-06-23'::Date - toIntervalDay(36) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(74) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(36) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'attrs' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 864 second) as period, count() as count FROM pypi WHERE project = 'attrs' AND date >= '2023-06-23'::Date - toIntervalDay(32) AND date <= '2023-06-23'::Date - toIntervalDay(31) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(32) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(31) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pytz' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 4320 second) as period, count() as count FROM pypi WHERE project = 'pytz' AND date >= '2023-06-23'::Date - toIntervalDay(49) AND date <= '2023-06-23'::Date - toIntervalDay(44) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(49) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(44) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pandas' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count FROM pypi WHERE project = 'pandas' AND date >= '2023-06-23'::Date - toIntervalDay(12) AND date <= '2023-06-23'::Date - toIntervalDay(6) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(12) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'markupsafe' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 21600 second) as period, count() as count FROM pypi WHERE project = 'markupsafe' AND date >= '2023-06-23'::Date - toIntervalDay(40) AND date <= '2023-06-23'::Date - toIntervalDay(15) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(40) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(15) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'jinja2' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count FROM pypi WHERE project = 'jinja2' AND date >= '2023-06-23'::Date - toIntervalDay(7) AND date <= '2023-06-23'::Date - toIntervalDay(4) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(7) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(4) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'cffi' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 31104 second) as period, count() as count FROM pypi WHERE project = 'cffi' AND date >= '2023-06-23'::Date - toIntervalDay(52) AND date <= '2023-06-23'::Date - toIntervalDay(16) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(52) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(16) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pyjwt' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count FROM pypi WHERE project = 'pyjwt' AND date >= '2023-06-23'::Date - toIntervalDay(8) AND date <= '2023-06-23'::Date - toIntervalDay(6) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(8) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pycparser' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count FROM pypi WHERE project = 'pycparser' AND date >= '2023-06-23'::Date - toIntervalDay(58) AND date <= '2023-06-23'::Date - toIntervalDay(52) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(58) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(52) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'aiobotocore' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 44064 second) as period, count() as count FROM pypi WHERE project = 'aiobotocore' AND date >= '2023-06-23'::Date - toIntervalDay(54) AND date <= '2023-06-23'::Date - toIntervalDay(3) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(54) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(3) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 's3fs' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 3456 second) as period, count() as count FROM pypi WHERE project = 's3fs' AND date >= '2023-06-23'::Date - toIntervalDay(77) AND date <= '2023-06-23'::Date - toIntervalDay(73) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(77) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(73) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'fsspec' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6048 second) as period, count() as count FROM pypi WHERE project = 'fsspec' AND date >= '2023-06-23'::Date - toIntervalDay(86) AND date <= '2023-06-23'::Date - toIntervalDay(79) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(86) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(79) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'grpcio-status' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count FROM pypi WHERE project = 'grpcio-status' AND date >= '2023-06-23'::Date - toIntervalDay(6) AND date <= '2023-06-23'::Date - toIntervalDay(3) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(3) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'googleapis-common-protos' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count FROM pypi WHERE project = 'googleapis-common-protos' AND date >= '2023-06-23'::Date - toIntervalDay(22) AND date <= '2023-06-23'::Date - toIntervalDay(19) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(22) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(19) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'docutils' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 37152 second) as period, count() as count FROM pypi WHERE project = 'docutils' AND date >= '2023-06-23'::Date - toIntervalDay(47) AND date <= '2023-06-23'::Date - toIntervalDay(4) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(47) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(4) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'google-auth' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6912 second) as period, count() as count FROM pypi WHERE project = 'google-auth' AND date >= '2023-06-23'::Date - toIntervalDay(24) AND date <= '2023-06-23'::Date - toIntervalDay(16) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(24) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(16) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'oauthlib' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 37152 second) as period, count() as count FROM pypi WHERE project = 'oauthlib' AND date >= '2023-06-23'::Date - toIntervalDay(70) AND date <= '2023-06-23'::Date - toIntervalDay(27) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(70) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(27) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'tomli' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 9504 second) as period, count() as count FROM pypi WHERE project = 'tomli' AND date >= '2023-06-23'::Date - toIntervalDay(14) AND date <= '2023-06-23'::Date - toIntervalDay(3) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(14) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(3) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'wrapt' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 7776 second) as period, count() as count FROM pypi WHERE project = 'wrapt' AND date >= '2023-06-23'::Date - toIntervalDay(20) AND date <= '2023-06-23'::Date - toIntervalDay(11) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(20) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(11) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'cachetools' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count FROM pypi WHERE project = 'cachetools' AND date >= '2023-06-23'::Date - toIntervalDay(4) AND date <= '2023-06-23'::Date - toIntervalDay(1) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(4) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pyparsing' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 11232 second) as period, count() as count FROM pypi WHERE project = 'pyparsing' AND date >= '2023-06-23'::Date - toIntervalDay(19) AND date <= '2023-06-23'::Date - toIntervalDay(6) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(19) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'werkzeug' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 11232 second) as period, count() as count FROM pypi WHERE project = 'werkzeug' AND date >= '2023-06-23'::Date - toIntervalDay(79) AND date <= '2023-06-23'::Date - toIntervalDay(66) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(79) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(66) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'sqlalchemy' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 28512 second) as period, count() as count FROM pypi WHERE project = 'sqlalchemy' AND date >= '2023-06-23'::Date - toIntervalDay(59) AND date <= '2023-06-23'::Date - toIntervalDay(26) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(59) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(26) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'requests-oauthlib' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6912 second) as period, count() as count FROM pypi WHERE project = 'requests-oauthlib' AND date >= '2023-06-23'::Date - toIntervalDay(72) AND date <= '2023-06-23'::Date - toIntervalDay(64) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(72) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(64) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'multidict' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count FROM pypi WHERE project = 'multidict' AND date >= '2023-06-23'::Date - toIntervalDay(7) AND date <= '2023-06-23'::Date - toIntervalDay(5) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(7) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(5) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'yarl' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 7776 second) as period, count() as count FROM pypi WHERE project = 'yarl' AND date >= '2023-06-23'::Date - toIntervalDay(50) AND date <= '2023-06-23'::Date - toIntervalDay(41) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(50) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(41) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pyarrow' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6048 second) as period, count() as count FROM pypi WHERE project = 'pyarrow' AND date >= '2023-06-23'::Date - toIntervalDay(27) AND date <= '2023-06-23'::Date - toIntervalDay(20) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(27) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(20) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'jsonschema' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 10368 second) as period, count() as count FROM pypi WHERE project = 'jsonschema' AND date >= '2023-06-23'::Date - toIntervalDay(79) AND date <= '2023-06-23'::Date - toIntervalDay(67) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(79) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(67) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'platformdirs' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 30240 second) as period, count() as count FROM pypi WHERE project = 'platformdirs' AND date >= '2023-06-23'::Date - toIntervalDay(71) AND date <= '2023-06-23'::Date - toIntervalDay(36) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(71) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(36) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'async-timeout' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 23328 second) as period, count() as count FROM pypi WHERE project = 'async-timeout' AND date >= '2023-06-23'::Date - toIntervalDay(42) AND date <= '2023-06-23'::Date - toIntervalDay(15) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(42) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(15) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'aiohttp' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 4320 second) as period, count() as count FROM pypi WHERE project = 'aiohttp' AND date >= '2023-06-23'::Date - toIntervalDay(28) AND date <= '2023-06-23'::Date - toIntervalDay(23) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(28) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(23) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'isodate' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 39744 second) as period, count() as count FROM pypi WHERE project = 'isodate' AND date >= '2023-06-23'::Date - toIntervalDay(63) AND date <= '2023-06-23'::Date - toIntervalDay(17) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(63) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(17) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'psutil' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6048 second) as period, count() as count FROM pypi WHERE project = 'psutil' AND date >= '2023-06-23'::Date - toIntervalDay(37) AND date <= '2023-06-23'::Date - toIntervalDay(30) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(37) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(30) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pydantic' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 34560 second) as period, count() as count FROM pypi WHERE project = 'pydantic' AND date >= '2023-06-23'::Date - toIntervalDay(58) AND date <= '2023-06-23'::Date - toIntervalDay(18) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(58) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(18) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'decorator' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 38016 second) as period, count() as count FROM pypi WHERE project = 'decorator' AND date >= '2023-06-23'::Date - toIntervalDay(60) AND date <= '2023-06-23'::Date - toIntervalDay(16) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(60) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(16) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pyasn1-modules' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 3456 second) as period, count() as count FROM pypi WHERE project = 'pyasn1-modules' AND date >= '2023-06-23'::Date - toIntervalDay(52) AND date <= '2023-06-23'::Date - toIntervalDay(48) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(52) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(48) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'soupsieve' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 34560 second) as period, count() as count FROM pypi WHERE project = 'soupsieve' AND date >= '2023-06-23'::Date - toIntervalDay(81) AND date <= '2023-06-23'::Date - toIntervalDay(41) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(81) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(41) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'flask' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 14688 second) as period, count() as count FROM pypi WHERE project = 'flask' AND date >= '2023-06-23'::Date - toIntervalDay(41) AND date <= '2023-06-23'::Date - toIntervalDay(24) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(41) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(24) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pluggy' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 70848 second) as period, count() as count FROM pypi WHERE project = 'pluggy' AND date >= '2023-06-23'::Date - toIntervalDay(88) AND date <= '2023-06-23'::Date - toIntervalDay(6) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(88) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pytest' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 14688 second) as period, count() as count FROM pypi WHERE project = 'pytest' AND date >= '2023-06-23'::Date - toIntervalDay(17) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(17) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'beautifulsoup4' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 25056 second) as period, count() as count FROM pypi WHERE project = 'beautifulsoup4' AND date >= '2023-06-23'::Date - toIntervalDay(63) AND date <= '2023-06-23'::Date - toIntervalDay(34) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(63) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(34) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'lxml' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 49248 second) as period, count() as count FROM pypi WHERE project = 'lxml' AND date >= '2023-06-23'::Date - toIntervalDay(61) AND date <= '2023-06-23'::Date - toIntervalDay(4) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(61) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(4) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'filelock' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 35424 second) as period, count() as count FROM pypi WHERE project = 'filelock' AND date >= '2023-06-23'::Date - toIntervalDay(60) AND date <= '2023-06-23'::Date - toIntervalDay(19) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(60) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(19) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'grpcio' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 33696 second) as period, count() as count FROM pypi WHERE project = 'grpcio' AND date >= '2023-06-23'::Date - toIntervalDay(56) AND date <= '2023-06-23'::Date - toIntervalDay(17) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(56) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(17) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'greenlet' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 51840 second) as period, count() as count FROM pypi WHERE project = 'greenlet' AND date >= '2023-06-23'::Date - toIntervalDay(88) AND date <= '2023-06-23'::Date - toIntervalDay(28) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(88) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(28) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'frozenlist' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6048 second) as period, count() as count FROM pypi WHERE project = 'frozenlist' AND date >= '2023-06-23'::Date - toIntervalDay(85) AND date <= '2023-06-23'::Date - toIntervalDay(78) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(85) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(78) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'coverage' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 31968 second) as period, count() as count FROM pypi WHERE project = 'coverage' AND date >= '2023-06-23'::Date - toIntervalDay(40) AND date <= '2023-06-23'::Date - toIntervalDay(3) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(40) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(3) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'aiosignal' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 38880 second) as period, count() as count FROM pypi WHERE project = 'aiosignal' AND date >= '2023-06-23'::Date - toIntervalDay(88) AND date <= '2023-06-23'::Date - toIntervalDay(43) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(88) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(43) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'azure-core' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count FROM pypi WHERE project = 'azure-core' AND date >= '2023-06-23'::Date - toIntervalDay(39) AND date <= '2023-06-23'::Date - toIntervalDay(36) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(39) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(36) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'scipy' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 29376 second) as period, count() as count FROM pypi WHERE project = 'scipy' AND date >= '2023-06-23'::Date - toIntervalDay(69) AND date <= '2023-06-23'::Date - toIntervalDay(35) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(69) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(35) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pillow' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 42336 second) as period, count() as count FROM pypi WHERE project = 'pillow' AND date >= '2023-06-23'::Date - toIntervalDay(78) AND date <= '2023-06-23'::Date - toIntervalDay(29) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(78) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(29) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'tqdm' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 18144 second) as period, count() as count FROM pypi WHERE project = 'tqdm' AND date >= '2023-06-23'::Date - toIntervalDay(63) AND date <= '2023-06-23'::Date - toIntervalDay(42) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(63) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(42) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pyrsistent' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count FROM pypi WHERE project = 'pyrsistent' AND date >= '2023-06-23'::Date - toIntervalDay(6) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'virtualenv' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count FROM pypi WHERE project = 'virtualenv' AND date >= '2023-06-23'::Date - toIntervalDay(19) AND date <= '2023-06-23'::Date - toIntervalDay(13) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(19) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(13) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'et-xmlfile' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 20736 second) as period, count() as count FROM pypi WHERE project = 'et-xmlfile' AND date >= '2023-06-23'::Date - toIntervalDay(85) AND date <= '2023-06-23'::Date - toIntervalDay(61) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(85) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(61) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'openpyxl' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 24192 second) as period, count() as count FROM pypi WHERE project = 'openpyxl' AND date >= '2023-06-23'::Date - toIntervalDay(43) AND date <= '2023-06-23'::Date - toIntervalDay(15) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(43) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(15) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'importlib-resources' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 36288 second) as period, count() as count FROM pypi WHERE project = 'importlib-resources' AND date >= '2023-06-23'::Date - toIntervalDay(55) AND date <= '2023-06-23'::Date - toIntervalDay(13) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(55) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(13) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pyopenssl' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 19008 second) as period, count() as count FROM pypi WHERE project = 'pyopenssl' AND date >= '2023-06-23'::Date - toIntervalDay(28) AND date <= '2023-06-23'::Date - toIntervalDay(6) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(28) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'iniconfig' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 18144 second) as period, count() as count FROM pypi WHERE project = 'iniconfig' AND date >= '2023-06-23'::Date - toIntervalDay(75) AND date <= '2023-06-23'::Date - toIntervalDay(54) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(75) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(54) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pygments' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 17280 second) as period, count() as count FROM pypi WHERE project = 'pygments' AND date >= '2023-06-23'::Date - toIntervalDay(24) AND date <= '2023-06-23'::Date - toIntervalDay(4) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(24) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(4) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'chardet' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count FROM pypi WHERE project = 'chardet' AND date >= '2023-06-23'::Date - toIntervalDay(49) AND date <= '2023-06-23'::Date - toIntervalDay(47) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(49) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(47) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'asn1crypto' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 34560 second) as period, count() as count FROM pypi WHERE project = 'asn1crypto' AND date >= '2023-06-23'::Date - toIntervalDay(41) AND date <= '2023-06-23'::Date - toIntervalDay(1) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(41) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'itsdangerous' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 17280 second) as period, count() as count FROM pypi WHERE project = 'itsdangerous' AND date >= '2023-06-23'::Date - toIntervalDay(39) AND date <= '2023-06-23'::Date - toIntervalDay(19) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(39) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(19) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'exceptiongroup' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count FROM pypi WHERE project = 'exceptiongroup' AND date >= '2023-06-23'::Date - toIntervalDay(18) AND date <= '2023-06-23'::Date - toIntervalDay(16) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(18) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(16) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'websocket-client' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 864 second) as period, count() as count FROM pypi WHERE project = 'websocket-client' AND date >= '2023-06-23'::Date - toIntervalDay(15) AND date <= '2023-06-23'::Date - toIntervalDay(14) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(15) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(14) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'tabulate' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6048 second) as period, count() as count FROM pypi WHERE project = 'tabulate' AND date >= '2023-06-23'::Date - toIntervalDay(7) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(7) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'google-api-python-client' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 864 second) as period, count() as count FROM pypi WHERE project = 'google-api-python-client' AND date >= '2023-06-23'::Date - toIntervalDay(1) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'requests-toolbelt' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count FROM pypi WHERE project = 'requests-toolbelt' AND date >= '2023-06-23'::Date - toIntervalDay(5) AND date <= '2023-06-23'::Date - toIntervalDay(3) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(5) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(3) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'google-cloud-core' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 7776 second) as period, count() as count FROM pypi WHERE project = 'google-cloud-core' AND date >= '2023-06-23'::Date - toIntervalDay(11) AND date <= '2023-06-23'::Date - toIntervalDay(2) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(11) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(2) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'mypy-extensions' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 864 second) as period, count() as count FROM pypi WHERE project = 'mypy-extensions' AND date >= '2023-06-23'::Date - toIntervalDay(15) AND date <= '2023-06-23'::Date - toIntervalDay(14) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(15) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(14) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'pynacl' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 21600 second) as period, count() as count FROM pypi WHERE project = 'pynacl' AND date >= '2023-06-23'::Date - toIntervalDay(42) AND date <= '2023-06-23'::Date - toIntervalDay(17) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(42) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(17) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'google-cloud-storage' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 18144 second) as period, count() as count FROM pypi WHERE project = 'google-cloud-storage' AND date >= '2023-06-23'::Date - toIntervalDay(44) AND date <= '2023-06-23'::Date - toIntervalDay(23) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(44) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(23) GROUP BY period ORDER BY period ASC;"
,"SELECT toStartOfDay(date), count() as count FROM pypi WHERE project = 'psycopg2-binary' AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY date ORDER BY date ASC;"
,"SELECT toStartOfInterval(timestamp, INTERVAL 8640 second) as period, count() as count FROM pypi WHERE project = 'psycopg2-binary' AND date >= '2023-06-23'::Date - toIntervalDay(33) AND date <= '2023-06-23'::Date - toIntervalDay(23) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(33) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(23) GROUP BY period ORDER BY period ASC;"
]; // end of queries

    </script>
</head>
<body>

<div class="header stick-left">
    <span class="nowrap themes"><span id="toggle-dark"></span><span id="toggle-light"></span></span>
    <h1>ClickHouse vs Snowflake - Downloads per Day</h1>
    <a href="https://github.com/ClickHouse/clickhouse_vs_snowflake/">Methodology</a> | <a href="https://github.com/ClickHouse/clickhouse_vs_snowflake/">Reproduce and Validate the Results</a> | <a href="https://github.com/ClickHouse/clickhouse_vs_snowflake/">Add a System</a> | <a href="https://github.com/ClickHouse/clickhouse_vs_snowflake/">Report Mistake</a>
</div>

<table class="selectors-container stick-left">
    <tr>
        <th>System: </th>
        <td id="selectors_system">
            <a id="select-all-systems" class="selector selector-active">All</a>
        </td>
    </tr>
    <tr>
        <th>Type: </th>
        <td id="selectors_type">
            <a id="select-all-types" class="selector selector-active">All</a>
        </td>
    </tr>
    <tr>
        <th>Machine: </th>
        <td id="selectors_machine">
            <a id="select-all-machines" class="selector selector-active">All</a>
        </td>
    </tr>
    <tr>
        <th>Configuration: </th>
        <td id="selectors_config">
            <a id="select-all-configs" class="selector selector-active">All</a>
        </td>
    </tr>
    <tr>
        <th>Metric: </th>
        <td id="selectors_run">
            <a class="selector" id="selector-metric-cold">Cold Run</a>
            <a class="selector" id="selector-metric-hot">Hot Run</a>
            <a class="selector" id="selector-metric-size">Storage Size</a>
        </td>
    </tr>
</table>

<table class="stick-left comparison">
    <thead>
        <tr>
            <th class="summary-name">
                System &amp; Machine
            </th>
            <th colspan="2">
                Relative <span id="time-or-size">time</span> (lower is better)
            </th>
        </tr>
    </thead>
    <tbody id="summary">
    </tbody>
</table>

<div id="nothing-selected" class="stick-left">Nothing selected</div>

<div class="stick-left comparison">
    <h2>Detailed Comparison</h2>
</div>

<table id="details">
    <thead>
        <tr id="details_head">
        </tr>
    </thead>
    <tbody id="details_body">
    </tbody>
</table>

<script type="text/javascript">

const constant_time_add = 0.01;
const missing_result_penalty = 2;
const missing_result_time = 300;

let selectors = {
    "system": {},
    "type": {},
    "machine": {},
    "config": {},
    "metric": "hot",
    "queries": [],
};

let theme = 'light';

function setTheme(new_theme) {
    theme = new_theme;
    document.documentElement.setAttribute('data-theme', theme);
    window.localStorage.setItem('theme', theme);
    render();
}

document.getElementById('toggle-light').addEventListener('click', e => setTheme('light'));
document.getElementById('toggle-dark').addEventListener('click', e => setTheme('dark'));

let new_theme = window.localStorage.getItem('theme');
if (new_theme && new_theme != theme) {
    setTheme(new_theme);
}

/// Generate selectors

let systems = document.getElementById('selectors_system');
let types = document.getElementById('selectors_type');
let machines = document.getElementById('selectors_machine');
let configs = document.getElementById('selectors_config');

let unique_systems = [... new Set(data.map(elem => elem.system))];

function toggle(e, elem, selectors_map) {
    selectors_map[elem] = !selectors_map[elem];
    e.target.className = selectors_map[elem] ? 'selector selector-active' : 'selector';
    render();
    updateHistory();
}

function toggleAll(e, selectors_map) {
    const new_value = Object.keys(selectors_map).filter(k => selectors_map[k]).length * 2 < Object.keys(selectors_map).length;
    [...e.target.parentElement.querySelectorAll('a')].map(
        elem => { elem.className = new_value ? 'selector selector-active' : 'selector' });

    Object.keys(selectors_map).map(k => { selectors_map[k] = new_value });
    render();
    updateHistory();
}

unique_systems.map(elem => {
    let selector = document.createElement('a');
    selector.className = 'selector selector-active';
    selector.appendChild(document.createTextNode(elem));
    systems.appendChild(selector);
    if (!(elem in selectors.system)) { selectors.system[elem] = data.some(entry => entry.system == elem && !entry.hide); }
    selector.addEventListener('click', e => toggle(e, elem, selectors.system));

    /// Highlighting summary rows and table columns on hovering over the system selector.
    selector.addEventListener('mouseover', e => {
        [...document.querySelectorAll('.summary-row')].map(row => {
            row.className = row.dataset.system == elem ? 'summary-row summary-row-hilite' : 'summary-row' });
        [...document.querySelectorAll('.th-entry')].map(th => {
            th.className = th.dataset.system == elem ? 'th-entry th-entry-hilite' : 'th-entry' });
    });
    selector.addEventListener('mouseout', e => {
        [...document.querySelectorAll('.summary-row')].map(row => { row.className = 'summary-row' });
        [...document.querySelectorAll('.th-entry')].map(row => { row.className = 'th-entry' });
    });
});

[... new Set(data.map(elem => elem.tags).flat())].map(elem => {
    let selector = document.createElement('a');
    selector.className = 'selector selector-active';
    selector.appendChild(document.createTextNode(elem));
    types.appendChild(selector);
    if (!(elem in selectors.type)) { selectors.type[elem] = true; }
    selector.addEventListener('click', e => toggle(e, elem, selectors.type));
});

[... new Set(data.map(elem => elem.machine))].map(elem => {
    let selector = document.createElement('a');
    selector.className = 'selector selector-active';
    selector.appendChild(document.createTextNode(elem));
    machines.appendChild(selector);
    if (!(elem in selectors.machine)) { selectors.machine[elem] = true; }
    selector.addEventListener('click', e => toggle(e, elem, selectors.machine));
});

[... new Set(data.map(elem => elem.config))].sort(
    (a, b) => ((typeof(b) === 'number') - (typeof(a) === 'number')) || (a - b)).map(elem => {
    let selector = document.createElement('a');
    selector.className = 'selector selector-active';
    selector.appendChild(document.createTextNode(elem));
    configs.appendChild(selector);
    if (!(elem in selectors.config)) { selectors.config[elem] = true; }
    selector.addEventListener('click', e => toggle(e, elem, selectors.config));
});

document.getElementById('select-all-systems').addEventListener('click', e => toggleAll(e, selectors.system));
document.getElementById('select-all-types').addEventListener('click', e => toggleAll(e, selectors.type));
document.getElementById('select-all-machines').addEventListener('click', e => toggleAll(e, selectors.machine));
document.getElementById('select-all-configs').addEventListener('click', e => toggleAll(e, selectors.config));

[...document.getElementById('selectors_run').querySelectorAll('a')].map(elem => elem.addEventListener('click', e => {
    [...e.target.parentElement.querySelectorAll('a')].map(elem => { elem.className = elem == e.target ? 'selector selector-active' : 'selector' });
}));

document.getElementById('selector-metric-cold').addEventListener('click', e => { selectors.metric = 'cold'; render(); updateHistory(); });
document.getElementById('selector-metric-hot').addEventListener('click', e => { selectors.metric = 'hot'; render(); updateHistory(); });
document.getElementById('selector-metric-size').addEventListener('click', e => { selectors.metric = 'size'; render(); updateHistory(); });

selectors.queries = [...data[0].result.keys()].map(k => true);

function updateSelectors() {
    [...systems.childNodes].map(elem => { elem.className = selectors.system[elem.innerText] ? 'selector selector-active' : 'selector' });
    [...types.childNodes].map(elem => { elem.className = selectors.type[elem.innerText] ? 'selector selector-active' : 'selector' });
    [...machines.childNodes].map(elem => { elem.className = selectors.machine[elem.innerText] ? 'selector selector-active' : 'selector' });
    [...configs.childNodes].map(elem => { elem.className = selectors.config[elem.innerText] ? 'selector selector-active' : 'selector' });

    [...document.getElementById('selectors_run').querySelectorAll('a')].map(elem => {
        elem.className = elem.id == 'selector-metric-' + selectors.metric ? 'selector selector-active' : 'selector' });

    [...document.querySelectorAll('.query-checkbox')].map((elem, i) => { elem.checked = selectors.queries[i] });
}

function clearElement(elem)
{
    while (elem.firstChild) {
        elem.removeChild(elem.lastChild);
    }
}

function selectRun(timings) {
    return selectors.metric == 'cold' ? timings[0] : (timings.some(timing => timing !== null) ? Math.min(...timings.slice(1).filter(timing => timing !== null)) : null)
}

function addNote(text) {
    let note = document.createElement('sup');
    note.className = 'note';
    note.appendChild(document.createTextNode(''));

    let tooltip = document.createElement('span');
    tooltip.className = 'tooltip tooltip-result';
    tooltip.appendChild(document.createTextNode(text));

    note.appendChild(tooltip);
    return note;
}

function renderSummary(filtered_data) {
    let table = document.getElementById('summary');
    clearElement(table);

    /// Generate summary

    /// The algorithm: for each of the queries,
    /// - if there is a result - take query duration, add 10 ms, and divide it to the corresponding value from the baseline,
    /// - if there is no result - take the worse query duration across all query runs for this system and multiply by 2.
    /// Take geometric mean across the queries.

    let summary = {};

    const num_queries = filtered_data[0].result.length;

    const baseline_data = [...filtered_data[0].result.keys()].map(query_num =>
        [...Array(5).keys()].map(run_num =>
            Math.min(...filtered_data.filter(elem => !elem.fake).map(elem => elem.result[query_num][run_num]).filter(x => x))));

    const min_data_size = Math.min(...filtered_data.map(elem => elem.data_size).filter(x => x));

    let summaries;
    if (selectors.metric == 'size') {
        summaries = filtered_data.map(elem => elem.data_size / min_data_size);
        document.getElementById('time-or-size').innerText = 'size';
    } else {
        summaries = filtered_data.map(elem => {
            const fallback_timing = missing_result_penalty * Math.max(missing_result_time, ...elem.result.map(timings => selectRun(timings)));

            let accumulator = 0;
            let used_queries = 0;

            const no_queries_selected = selectors.queries.filter(x => x).length == 0;

            for (let i = 0; i < num_queries; ++i) {
                if (no_queries_selected || selectors.queries[i]) {
                    const curr_timing = selectRun(elem.result[i]) ?? fallback_timing;
                    const baseline_timing = selectRun(baseline_data[i]);
                    const ratio = (constant_time_add + curr_timing) / (constant_time_add + baseline_timing);
                    accumulator += Math.log(ratio);
                    ++used_queries;
                }
            }

            return Math.exp(accumulator / used_queries);
        });
        document.getElementById('time-or-size').innerText = 'time';
    }

    const sorted_indices = [...summaries.keys()].sort((a, b) => summaries[a] - summaries[b]);
    const max_ratio = summaries[sorted_indices[sorted_indices.length - 1]];

    sorted_indices.map(idx => {
        const elem = filtered_data[idx];

        if (selectors.metric == 'size' && elem.data_size === null) { return; }

        let tr = document.createElement('tr');
        tr.className = 'summary-row';

        tr.dataset.system = elem.system;

        let td_name = document.createElement('td');
        td_name.className = 'summary-name';

        if (!elem.fake) {
            let link = document.createElement('a');
            link.appendChild(document.createTextNode(`${elem.system} (${Number.isInteger(elem.config) && elem.config > 1 ? elem.config + '': ''}${elem.machine} - ${elem.config})`));
            link.href = "https://github.com/ClickHouse/clickhouse_vs_snowflake/blob/main/" + elem.source;
            td_name.appendChild(link);
        } else {
            td_name.appendChild(document.createTextNode(elem.system));
        }

        if (elem.comment) { td_name.appendChild(addNote(elem.comment)); }
        td_name.appendChild(document.createTextNode(': '));

        const ratio = summaries[idx];
        const percentage = summaries[idx] / max_ratio * 100;

        let td_number = document.createElement('td');
        td_number.className = 'summary-number';

        const text = selectors.metric == 'size' ? `${(elem.data_size / 1024 / 1024 / 1024).toFixed(2)} GiB (${ratio.toFixed(2)})`
            : `${ratio.toFixed(2)}`;

        td_number.appendChild(document.createTextNode(text));

        let td_bar = document.createElement('td');
        td_bar.className = 'summary-bar-cell';

        let bar = document.createElement('div');

        bar.className = `summary-bar`;
        bar.style.width = `${percentage}%`;

        td_bar.appendChild(bar);

        tr.appendChild(td_name);
        tr.appendChild(td_bar);
        tr.appendChild(td_number);
        table.appendChild(tr);
    });

    return [sorted_indices, baseline_data];
}

function colorize(elem, ratio) {
    let [r, g, b] = [0, 0, 0];

    /// ratio less than 1 - green
    /// ratio from 1 to 2 - green to yellow
    /// ratio from 2 to 10 - yellow to red
    /// ratio from 10 to 1000 to infinity - red to brown to black

    /// Note: we are using RGB space without proper gamma correction. Read more: https://www.handprint.com/HP/WCL/color1.html

    if (ratio !== null) {
        if (ratio < 1) {
            r = 232;
            g = 255;
            b = 232;
        } else if (ratio <= 1) {
            g = 255;
        } else if (ratio <= 2) {
            g = 255;
            r = (ratio - 1) * 255;
        } else if (ratio <= 10) {
            g = (10 - ratio) / 8 * 255;
            r = 255;
        } else {
            r = (1 - ((ratio - 10) / ((ratio - 10) + 1000))) * 255;
        }
    }

    if (document.documentElement.getAttribute('data-theme') == 'dark') {
        r /= 1.5;
        g /= 1.5;
        b /= 1.5;
    }

    elem.style.backgroundColor = `rgb(${r}, ${g}, ${b})`;
    if (ratio === null || ratio > 10) {
        /// This will look better on dark backgrounds
        elem.style.color = 'white';
    } else {
        elem.style.color = 'black';
    }

    /// The best result is highlighted
    if (ratio == 1) {
        elem.style.fontWeight = 'bold';
    }
}

function render() {
    let details_head = document.getElementById('details_head');
    let details_body = document.getElementById('details_body');

    clearElement(details_head);
    clearElement(details_body);

    let filtered_data = data.filter(elem =>
        selectors.system[elem.system] &&
        selectors.machine[elem.machine] &&
        selectors.config[elem.config] &&
        elem.tags.filter(type => selectors.type[type]).length > 0);

    let nothing_selected_elem = document.getElementById('nothing-selected');
    if (filtered_data.length == 0) {
        nothing_selected_elem.style.display = 'block';
        [...document.querySelectorAll('.comparison')].map(e => e.style.display = 'none');
        return;
    }
    nothing_selected_elem.style.display = 'none';
    [...document.querySelectorAll('.comparison')].map(e => e.style.display = 'block');

    if (selectors.metric == 'size') {
        filtered_data = [...filtered_data];
    }

    let [sorted_indices, baseline_data] = renderSummary(filtered_data);
    sorted_indices = sorted_indices.filter(idx => !filtered_data[idx].fake);

    /// Generate details

    /// Global checkbox
    {
        let th_checkbox = document.createElement('th');
        let checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.checked = true;
        checkbox.addEventListener('change', e => {
            [...document.querySelectorAll('.query-checkbox')].map(elem => { elem.checked = e.target.checked });
            selectors.queries.map((_, i) => { selectors.queries[i] = e.target.checked });
            renderSummary(filtered_data);
            updateHistory();
        });
        th_checkbox.appendChild(checkbox);
        details_head.appendChild(th_checkbox);
        details_head.appendChild(document.createElement('th'));
    }

    /// Table header
    sorted_indices.map(idx => {
        const elem = filtered_data[idx];
        let th = document.createElement('th');
        th.appendChild(document.createTextNode(`${elem.system}\n(${Number.isInteger(elem.config) && elem.config > 1 ? elem.config + '': ''}${elem.machine} - \n ${elem.config})`));
        th.className = 'th-entry';
        th.dataset.system = elem.system;
        details_head.appendChild(th);
    });



    /// Data sizes
    {
        let tr = document.createElement('tr');
        tr.className = 'shadow';

        let td_title = document.createElement('td');
        td_title.colSpan = 2;
        td_title.appendChild(document.createTextNode('Data size: '));
        tr.appendChild(td_title);

        sorted_indices.map(idx => {
            const curr_size = filtered_data[idx].data_size;
            const baseline_size = Math.min(...filtered_data.map(elem => elem.data_size).filter(x => x));
            const ratio = curr_size !== null ? curr_size / baseline_size : null;

            let td = document.createElement('td');
            td.appendChild(document.createTextNode(curr_size !== null ? `${(curr_size / 1024 / 1024 / 1024).toFixed(2)} GiB (${ratio.toFixed(2)})` : ''));

            colorize(td, ratio);
            tr.appendChild(td);
        });

        details_body.appendChild(tr);
    }

    /// Query runtimes
    const num_queries = filtered_data[0].result.length;

    for (let query_num = 0; query_num < num_queries; ++query_num) {
        let tr = document.createElement('tr');
        tr.className = 'shadow';

        let td_checkbox = document.createElement('td');
        let checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.className = 'query-checkbox';
        checkbox.checked = selectors.queries[query_num];
        checkbox.addEventListener('change', e => {
            selectors.queries[query_num] = e.target.checked;
            renderSummary(filtered_data);
            updateHistory();
        });
        td_checkbox.appendChild(checkbox);
        tr.appendChild(td_checkbox);

        let td_query_num = document.createElement('td');
        td_query_num.className = 'note';
        td_query_num.appendChild(document.createTextNode(`Q${query_num}. `));

        let tooltip = document.createElement('span');
        tooltip.className = 'tooltip tooltip-query';
        tooltip.appendChild(document.createTextNode(`Query ${query_num}: ${queries[query_num]}`));
        td_query_num.appendChild(tooltip);

        tr.appendChild(td_query_num);

        sorted_indices.map(idx => {
            const curr_timing = selectRun(filtered_data[idx].result[query_num]);
            const baseline_timing = selectRun(baseline_data[query_num]);
            const ratio = curr_timing !== null ? (constant_time_add + curr_timing) / (constant_time_add + baseline_timing) : null;

            let td = document.createElement('td');
            td.appendChild(document.createTextNode(curr_timing !== null ? `${curr_timing.toFixed(2)}s (${ratio.toFixed(2)})` : ''));

            colorize(td, ratio);
            tr.appendChild(td);
        });

        details_body.appendChild(tr);
    }
}

function updateHistory() {
    history.pushState(selectors, '',
        window.location.pathname + (window.location.search || '') + '#' + btoa(JSON.stringify(selectors)));
}

window.onpopstate = function(event) {
    if (!event.state) { return; }
    selectors = event.state;
    render();
    updateSelectors();
};

if (window.location.hash) {
    try {
        selectors = JSON.parse(atob(window.location.hash.substring(1)));
    } catch {}
}

render();
updateSelectors();

</script>
</body>
</html>
