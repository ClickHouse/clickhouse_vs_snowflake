<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ClickHouse vs Snowflake - Downloads per Day by Python Version</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="icon" href="data:image/gif;base64,R0lGODlhIAAgAOMPAHMUEmkyHOcbF8UvJts/E3BeOih1YziiQmebLt2AFjeyQKqZKNWPjLybfPfcDP///yH5BAEKAA8ALAAAAAAgACAAAATg8MlJ6ws26z0EGcQmZgAhnN6oPg0wDA0zrGMTAADDxEJCZ4Gba8c4hX4Uw+XWeYGOyMdhgkuYrAToqIBQHBCIKQ6wcJhPyINarUBcyuYE+ndQeOsKuNlxmv3CdnZfew5yAlEPC12BhFhZiBJ2CI1GkBMHeoV9PpYPhIUDBqIFnZ8EBaKplqYMqaqIewl8A6iupFF7C1YCoaJqq4UOWQIBBmtTuIQmWWxekJQeYWuWcFYPfl+dLAELOxML2hIYDeEWt7flEufknTZB7+8NBeyINxjqDwU4QYg26BTu6KVTEQEAOw==">
    <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">

    <style>
        :root {
            --color: black;
            --title-color: black;
            --background-color: white;

            --link-color: #08F;
            --link-hover-color: #F40;

            --selector-text-color: black;
            --selector-active-text-color: black;
            --selector-background-color: #EEE;
            --selector-active-background-color: #FFCB80;
            --selector-hover-text-color: black;
            --selector-hover-background-color: #FDB;

            --summary-every-other-row-color: #F8F8F8;
            --highlight-color: #EEE;
            --bar-color: #FFCB80;

            --tooltip-text-color: white;
            --tooltip-background-color: black;

            --nothing-selected-color: #CCC;
            --shadow-color: grey;
        }

        [data-theme="dark"] {
            --color: #CCC;
            --title-color: white;
            --background-color: #04293A;

            --link-color: #8CF;
            --link-hover-color: #FFF;

            --selector-text-color: white;
            --selector-background-color: #444;
            --selector-active-text-color: white;
            --selector-active-background-color: #088;
            --selector-hover-text-color: black;
            --selector-hover-background-color: white;

            --summary-every-other-row-color: #042e41;
            --highlight-color: #064663;
            --bar-color: #088;

            --tooltip-text-color: white;
            --tooltip-background-color: #444;

            --nothing-selected-color: #666;
            --shadow-color: black;
        }

        html, body {
            color: var(--color);
            background-color: var(--background-color);
            width: 100%;
            height: 100%;
            margin: 0;
            overflow: auto;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            padding: 1% 3% 0 3%;
        }

        h1 {
            color: var(--title-color);
        }

        table {
             border-spacing: 1px;
        }

        .stick-left {
            position: sticky;
            left: 0px;
        }

        .selectors-container {
            padding: 2rem 0 2rem 0;
            user-select: none;
        }

        .selectors-container th {
            text-align: left;
            vertical-align: top;
            white-space: nowrap;
            padding-top: 0.5rem;
            padding-right: 1rem;
        }

        .selector {
            display: inline-block;
            margin-left: 0.1rem;
            padding: 0.2rem 0.5rem 0.2rem 0.5rem;
            background: var(--selector-background-color);
            color: var(--selector-text-color);
            border: 0.2rem solid var(--background-color);
            border-radius: 0.5rem;
        }

        .selector-active {
            color: var(--selector-active-text-color);
            background: var(--selector-active-background-color);
        }

        a, a:visited {
            text-decoration: none;
            color: var(--link-color);
            cursor: pointer;
        }

        a:hover {
            color: var(--link-hover-color);
        }

        .selector:hover {
            color: var(--selector-hover-text-color) !important;
            background: var(--selector-background-color);
        }

        .selector-active:hover {
            background: var(--selector-hover-background-color);
        }

        #summary tr:nth-child(odd) {
            background: var(--summary-every-other-row-color);
        }

        .summary-name {
            white-space: nowrap;
            text-align: right;
            padding-right: 1rem;
        }

        .summary-bar-cell {
            width: 100%;
        }

        .summary-bar {
            height: 1rem;
            background: var(--bar-color);
            border-radius: 0 0.2rem 0.2rem 0;
        }

        .summary-number {
            font-family: monospace;
            text-align: right;
            padding-left: 1rem;
            white-space: nowrap;
        }

        th {
            padding-bottom: 0.5rem;
        }

        .th-entry-hilite {
            background: var(--highlight-color);
            font-weight: bold;
        }

        .summary-row:hover, .summary-row-hilite {
            background: var(--highlight-color) !important;
            font-weight: bold;
        }

        #details {
            padding-bottom: 1rem;
        }

        #details th {
            vertical-align: bottom;
            white-space: pre;
        }

        #details td {
            white-space: pre;
            font-family: monospace;
            text-align: right;
            padding: 0.1rem 0.5rem 0.1rem 0.5rem;
        }

        .shadow:hover {
            box-shadow: 0 0 1rem var(--shadow-color);
            position: relative;
        }

        #nothing-selected {
            display: none;
            font-size: 32pt;
            font-weight: bold;
            color: var(--nothing-selected-color);
        }

        .note {
            position: relative;
            display: inline-block;
        }

        .tooltip {
            position: absolute;
            bottom: calc(100% + 0.5rem);
            visibility: hidden;
            background-color: var(--tooltip-background-color);
            color: var(--tooltip-text-color);
            box-shadow: 0 0 1rem var(--shadow-color);
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            z-index: 1;
            text-align: left;
            white-space: normal;
        }

        .tooltip-result {
            left: calc(50% - 0.25rem);
            width: 20rem;
            margin-left: -10rem;
        }

        .tooltip-query {
            left: 0;
            width: 40rem;
            margin-left: -3rem;
        }

        .note:hover .tooltip {
            visibility: visible;
        }

        .tooltip::after {
            content: " ";
            position: absolute;
            top: 100%;
            border-width: 0.5rem;
            border-style: solid;
            border-color: var(--tooltip-background-color) transparent transparent transparent;
        }

        .tooltip-result::after {
            left: 50%;
            margin-left: -1rem;
        }

        .tooltip-query::after {
            left: 3rem;
            margin-left: 0.5rem;
        }

        .nowrap {
            text-wrap: none;
        }

        .themes {
            float: right;
            font-size: 200%;
            cursor: pointer;
        }

        #toggle-dark, #toggle-light {
            padding-right: 0.5rem;
            cursor: pointer;
        }

        #toggle-dark:hover, #toggle-light:hover {
            display: inline-block;
            transform: translate(1px, 1px);
            filter: brightness(125%);
        }
    </style>
    <script type="text/javascript">

const data = [
{"system":"ClickHouse","date":"2023-06-28","machine":"720_GB","config":"default","comment":"","tags":["Cloud"],"data_size":991638026556,"result":[[6.08,6.569,5.281],[4.334,5.02,4.193],[4.651,3.714,3.866],[0.476,0.363,1.621],[3.595,3.736,3.659],[0.615,0.227,0.615],[3.36,3.555,2.77],[0.901,1.56,0.581],[3.414,2.682,2.68],[1.211,0.506,0.499],[3.042,2.307,3.043],[0.426,0.959,0.315],[2.911,2.685,2.34],[1.1,0.42,0.325],[3.37,2.344,3.486],[1.3,0.535,0.532],[3.387,2.68,2.828],[1.467,1.009,0.794],[2.836,2.254,2.218],[0.989,0.968,0.449],[3.382,2.86,2.647],[1.472,0.981,0.514],[3.006,2.871,2.26],[1.756,1.536,1.514],[2.814,2.507,4.038],[0.654,0.212,0.211],[2.18,4.289,3.995],[0.378,0.349,0.145],[2.38,1.709,3.856],[0.969,1.059,1.819],[3.664,3.311,3.801],[0.905,0.398,0.927],[3.852,2.359,3.525],[1.58,2.299,2.162],[3.976,2.899,2.048],[1.185,0.639,0.425],[2,2.011,1.53],[0.706,0.802,0.219],[2.381,1.92,1.587],[1.148,0.165,0.43],[1.957,1.961,1.376],[1.287,0.613,0.656],[1.93,1.923,1.761],[1.256,1.086,1.001],[1.846,1.72,1.351],[0.418,0.729,0.348],[1.722,1.558,1.41],[0.774,0.526,0.242],[1.854,1.784,1.605],[0.731,0.6,0.373],[1.758,1.113,1.111],[0.729,0.684,0.352],[1.865,1.622,1.404],[0.48,0.64,0.352],[2.95,1.669,2.372],[1.729,0.893,0.929],[2.624,2.287,1.917],[0.989,0.42,0.085],[2.415,1.584,2.138],[0.834,0.295,0.298],[2.008,1.347,1.386],[0.599,0.132,0.479],[2.774,1.705,1.654],[0.587,0.395,0.356],[1.688,2.105,1.842],[0.568,0.392,0.181],[2.063,1.077,1.575],[0.956,0.834,0.707],[1.771,1.718,1.529],[0.438,0.089,0.094],[1.759,1.413,1.432],[0.708,0.753,0.513],[1.756,1.594,1.022],[0.832,0.747,0.098],[1.363,1.279,1.071],[0.3,0.082,0.091],[1.525,1.444,0.956],[0.401,1.499,0.136],[1.554,1.407,1.076],[0.364,0.099,0.11],[1.501,1.084,1.273],[0.752,0.85,0.392],[1.334,0.919,1.335],[1.296,0.715,0.743],[1.473,0.981,1.006],[0.958,0.206,0.197],[1.191,1.389,1.921],[0.61,0.467,0.202],[1.85,1.233,1.36],[1.169,1.026,0.743],[1.329,0.875,1.094],[0.874,0.49,0.559],[1.316,1.739,1.046],[0.435,0.427,0.201],[1.776,1.497,0.856],[0.598,0.305,0.093],[1.155,0.769,1.573],[0.554,0.241,0.229],[1.897,1.535,1.148],[0.827,0.941,0.342],[1.212,0.734,1.246],[0.567,0.18,0.374],[1.159,0.93,0.684],[0.404,0.66,0.183],[1.292,0.999,0.783],[0.671,0.172,0.766],[1.349,0.669,1.029],[0.784,0.366,0.928],[1.073,1.078,1.005],[0.718,0.545,0.116],[1.22,1.053,0.833],[0.631,0.567,1.009],[1.129,1.446,1.349],[1.072,1.012,0.727],[1.127,1.22,0.712],[0.392,0.677,0.121],[1.325,0.812,1.05],[0.659,0.341,0.979],[1.355,0.65,1.858],[0.711,0.214,0.597],[1.004,1.394,0.622],[0.437,0.231,0.517],[1.296,1.095,1.85],[0.666,0.337,0.931],[1.127,1.829,0.752],[0.609,0.305,0.103],[1.892,1.515,0.912],[0.517,0.801,0.328],[1.404,1.007,0.544],[0.365,0.49,0.139],[1.766,0.929,0.982],[1.112,0.752,0.54],[2.153,0.986,0.553],[1.187,0.498,0.808],[2.019,0.71,0.694],[0.859,0.715,0.189],[1.163,0.961,0.971],[0.88,0.36,0.466],[1.142,1.352,0.775],[0.457,0.773,0.096],[1.203,0.599,0.579],[0.372,0.106,0.425],[1.222,1.092,0.573],[0.442,0.414,0.105],[1.169,2.671,0.954],[0.614,0.325,0.221],[1.178,1.065,0.713],[0.623,0.484,0.408],[1.118,1.204,0.734],[0.804,0.468,0.097],[1.27,0.597,1.156],[1.537,0.661,1.2],[1.164,0.989,0.64],[0.651,0.417,1.119],[1.622,1.047,0.561],[0.737,0.806,0.867],[1.275,0.99,0.58],[0.689,0.289,0.289],[0.944,0.623,0.618],[0.462,0.866,0.234],[0.938,1.603,0.873],[1.235,0.81,1.049],[1.318,0.923,1.615],[0.607,0.393,0.156],[1.552,1.142,0.649],[1.089,0.495,0.476],[1.203,1.616,1.223],[0.386,0.519,0.153],[1.125,1.599,1.351],[0.794,0.673,0.56],[1.477,0.503,0.938],[0.783,0.687,0.307],[0.98,0.911,0.509],[0.549,0.484,0.081],[1.156,0.846,0.942],[0.791,0.513,0.487],[1.299,1.394,0.577],[0.88,1.184,0.359],[1.008,0.455,0.965],[1.179,1.153,0.488],[1.297,0.488,0.79],[0.578,0.112,0.79],[1.064,0.877,0.531],[0.673,0.386,0.762],[1.016,0.532,0.903],[1.159,0.364,0.391],[1.527,0.554,1.013],[0.952,0.494,0.195],[1.104,1.052,0.526],[0.732,0.382,0.641],[1.292,0.841,0.963],[1.092,0.603,0.356],[0.941,0.391,0.717],[0.812,0.114,0.423],[0.912,0.88,0.742],[0.383,0.608,0.102],[1.02,1.178,0.574],[0.751,0.339,0.744],[0.978,1.184,0.445],[0.645,0.237,0.6]],"source":"downloads_per_day_by_python_version/results/clickhouse_720_GB_default.json"}
,{"system":"Snowflake","date":"2023-06-28","machine":"2XLARGE","config":"date_project_cluster","comment":"","tags":["Cloud"],"data_size":1467343154176,"result":[[12.653,10.538,10.305],[6.803,6.669,6.688],[7.132,6.217,6.249],[1.627,1.223,1.012],[6.094,5.688,6.071],[1.328,0.916,2.081],[5.661,5.974,5.617],[2.642,1.831,1.809],[6.269,5.257,5.235],[1.685,1.543,1.353],[5.534,5.088,4.578],[1.17,1.052,0.681],[5.419,4.852,4.906],[1.404,2.092,1.323],[5.973,5.411,5.497],[2.311,2.176,1.836],[5.836,5.886,5.343],[2.792,2.876,2.519],[5.104,4.862,5.183],[1.553,1.206,1.619],[5.94,5.117,5.091],[2.478,1.931,1.849],[5.342,4.59,4.816],[2.993,3.549,2.838],[5.219,4.771,4.722],[1.463,1.01,1.089],[4.604,4.457,4.546],[0.986,1.234,0.942],[5.34,4.541,5.07],[1.679,4.068,1.83],[7.435,8.123,4.711],[5.345,1.939,1.837],[4.577,3.844,3.535],[2.47,6.125,2.921],[4.259,3.912,3.756],[1.499,1.368,1.759],[3.875,3.378,3.742],[0.999,1.371,1.011],[3.957,4.015,4.117],[1.099,1.047,1.373],[4.635,3.716,4.174],[1.51,1.479,1.758],[3.994,2.996,3.461],[2.725,2.418,2.356],[4.287,3.665,3.539],[1.078,1.389,1.021],[3.619,3.666,3.487],[1.284,1.333,0.925],[3.961,3.111,3.583],[1.859,1.843,1.308],[3.43,3.487,3.44],[0.887,1.308,1.254],[3.931,3.923,3.807],[1.384,0.877,0.857],[3.818,3.396,3.566],[2.825,2.489,2.89],[3.624,3.508,3.003],[1.134,1.094,0.948],[3.114,3.264,3.304],[1.154,1.479,1.578],[3.448,3.177,2.762],[1.027,1.022,0.812],[4.357,3.7,3.918],[1.373,0.891,1.309],[3.731,3.14,3.194],[1.236,0.938,1.278],[2.899,3.225,2.999],[2.411,2.087,2.513],[3.9,3.012,3.333],[1.208,0.951,1.229],[3.728,3.194,2.951],[1.715,1.318,1.536],[3.683,3.535,3.511],[0.826,1.062,0.788],[3.78,3.611,3.475],[0.962,0.981,1.253],[3.609,2.895,3.239],[1.144,1.174,0.881],[2.793,2.748,2.74],[1.079,1.011,0.616],[3.678,3.055,3.593],[1.666,1.79,1.546],[3.265,2.427,2.736],[1.994,1.532,2.004],[3.392,2.928,3.408],[1.149,0.999,0.702],[3.407,2.952,2.957],[1.532,1.171,1.109],[3.201,2.78,2.285],[2.142,2.182,1.962],[2.693,2.794,2.685],[1.383,1.37,1.643],[2.486,2.611,2.489],[0.913,0.972,0.934],[3.155,3.256,3.232],[1.103,0.816,0.9],[2.96,2.191,2.11],[0.793,0.95,0.781],[3.167,2.586,2.865],[1.28,1.655,1.665],[2.542,2.28,3.059],[1.709,0.779,0.826],[2.694,1.92,1.937],[0.918,1.144,1.167],[2.417,1.943,2.25],[1.107,1.038,1.259],[2.951,2.472,2.428],[1.459,1.721,1.804],[3.103,2.864,2.94],[0.866,1.122,1.047],[2.853,2.444,2.527],[1.529,1.122,1.497],[2.408,2.312,2.159],[2.264,1.912,1.679],[2.813,2.319,2.21],[1.247,1.007,1.24],[2.933,2.991,3.374],[1.313,1.507,1.81],[2.668,2.917,2.872],[1.084,1.169,1.134],[2.754,2.311,2.36],[1.617,2.779,1.049],[2.807,2.514,2.178],[1.263,1.802,1.629],[2.24,2.009,2.356],[0.781,0.679,1.027],[2.999,2.472,2.451],[0.95,1.384,1.037],[2.749,2.105,2.214],[0.925,0.977,0.761],[2.597,5,2.784],[1.62,1.308,1.312],[2.263,2.214,2.405],[1.954,1.866,1.505],[3.48,2.494,2.531],[0.958,1.043,1.3],[2.461,2.906,2.151],[1.383,1.409,1.479],[2.933,2.027,2.392],[1,1.273,0.916],[1.785,2.478,1.794],[0.612,1.235,0.734],[2.474,2.605,2.271],[0.829,0.932,0.901],[2.449,2.346,1.994],[0.892,1.002,0.607],[2.298,2.332,2.444],[1.502,1.261,1.084],[2.84,2.343,2.906],[1.038,0.966,1.034],[5.69,3.014,2.297],[2.595,2.635,2.329],[2.78,2.118,2.244],[1.835,1.602,1.476],[2.178,2.302,2.154],[1.717,1.594,1.138],[2.625,2.304,1.941],[0.964,1.382,0.977],[2.728,2,2.09],[1.459,1.337,1.492],[2.223,2.292,2.553],[1.669,1.582,2.016],[2.531,2.083,2.323],[1.24,1.183,0.902],[2.912,2.728,2.278],[2.046,1.727,2.03],[2.034,1.928,2.209],[1.752,0.847,0.679],[2.442,2.387,1.998],[1.455,1.186,1.447],[1.907,2.076,2.106],[1.111,1.121,1.578],[2.867,2.093,2.52],[0.866,0.815,0.891],[2.159,2.434,2.372],[1.405,1.315,1.896],[2.486,2.054,2.715],[1.835,1.483,1.552],[2.072,2.139,2.119],[1.862,1.981,1.719],[2.07,1.969,1.977],[1.105,0.863,0.901],[2.056,2.341,1.757],[1.47,1.098,1.072],[2.694,2.473,2.484],[1.462,1.434,1.845],[2.911,2.617,2.461],[1.567,1.137,0.786],[2.534,2.455,1.732],[1.354,1.128,0.833],[2.112,2.473,2.433],[2.37,1.547,1.772],[2.215,1.639,1.499],[0.634,1.044,0.967],[2.073,2.195,2.091],[1.02,0.799,0.764],[2.399,2.018,2.105],[2.042,1.936,1.721],[1.805,1.931,1.601],[0.857,0.884,1.253]],"source":"downloads_per_day_by_python_version/results/snowflake_2XLARGE_date_project_cluster.json"}
]; // end of data
const queries = [
"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'boto3') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 44928 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'boto3' AND date >= '2023-06-23'::Date - toIntervalDay(72) AND date <= '2023-06-23'::Date - toIntervalDay(20) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(72) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(20) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'urllib3') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'urllib3' AND date >= '2023-06-23'::Date - toIntervalDay(79) AND date <= '2023-06-23'::Date - toIntervalDay(76) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(79) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(76) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'requests') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 4320 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'requests' AND date >= '2023-06-23'::Date - toIntervalDay(8) AND date <= '2023-06-23'::Date - toIntervalDay(3) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(8) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(3) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'botocore') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 12096 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'botocore' AND date >= '2023-06-23'::Date - toIntervalDay(67) AND date <= '2023-06-23'::Date - toIntervalDay(53) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(67) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(53) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'charset-normalizer') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 8640 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'charset-normalizer' AND date >= '2023-06-23'::Date - toIntervalDay(32) AND date <= '2023-06-23'::Date - toIntervalDay(22) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(32) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(22) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'setuptools') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 864 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'setuptools' AND date >= '2023-06-23'::Date - toIntervalDay(53) AND date <= '2023-06-23'::Date - toIntervalDay(52) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(53) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(52) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'idna') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6912 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'idna' AND date >= '2023-06-23'::Date - toIntervalDay(8) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(8) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'certifi') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 17280 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'certifi' AND date >= '2023-06-23'::Date - toIntervalDay(25) AND date <= '2023-06-23'::Date - toIntervalDay(5) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(25) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(5) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 's3transfer') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 25920 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 's3transfer' AND date >= '2023-06-23'::Date - toIntervalDay(32) AND date <= '2023-06-23'::Date - toIntervalDay(2) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(32) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(2) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'python-dateutil') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 11232 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'python-dateutil' AND date >= '2023-06-23'::Date - toIntervalDay(15) AND date <= '2023-06-23'::Date - toIntervalDay(2) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(15) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(2) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'awscli') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 8640 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'awscli' AND date >= '2023-06-23'::Date - toIntervalDay(27) AND date <= '2023-06-23'::Date - toIntervalDay(17) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(27) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(17) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'typing-extensions') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 42336 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'typing-extensions' AND date >= '2023-06-23'::Date - toIntervalDay(67) AND date <= '2023-06-23'::Date - toIntervalDay(18) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(67) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(18) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'six') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'six' AND date >= '2023-06-23'::Date - toIntervalDay(18) AND date <= '2023-06-23'::Date - toIntervalDay(12) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(18) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(12) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pyyaml') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pyyaml' AND date >= '2023-06-23'::Date - toIntervalDay(2) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(2) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'google-api-core') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 16416 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'google-api-core' AND date >= '2023-06-23'::Date - toIntervalDay(87) AND date <= '2023-06-23'::Date - toIntervalDay(68) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(87) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(68) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'wheel') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 15552 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'wheel' AND date >= '2023-06-23'::Date - toIntervalDay(66) AND date <= '2023-06-23'::Date - toIntervalDay(48) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(66) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(48) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'cryptography') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 44928 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'cryptography' AND date >= '2023-06-23'::Date - toIntervalDay(52) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(52) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'packaging') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 15552 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'packaging' AND date >= '2023-06-23'::Date - toIntervalDay(28) AND date <= '2023-06-23'::Date - toIntervalDay(10) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(28) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(10) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'numpy') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6048 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'numpy' AND date >= '2023-06-23'::Date - toIntervalDay(11) AND date <= '2023-06-23'::Date - toIntervalDay(4) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(11) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(4) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pip') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pip' AND date >= '2023-06-23'::Date - toIntervalDay(18) AND date <= '2023-06-23'::Date - toIntervalDay(12) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(18) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(12) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'jmespath') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 18144 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'jmespath' AND date >= '2023-06-23'::Date - toIntervalDay(35) AND date <= '2023-06-23'::Date - toIntervalDay(14) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(35) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(14) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'importlib-metadata') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 43200 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'importlib-metadata' AND date >= '2023-06-23'::Date - toIntervalDay(89) AND date <= '2023-06-23'::Date - toIntervalDay(39) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(89) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(39) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'zipp') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 9504 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'zipp' AND date >= '2023-06-23'::Date - toIntervalDay(63) AND date <= '2023-06-23'::Date - toIntervalDay(52) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(63) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(52) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'click') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 10368 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'click' AND date >= '2023-06-23'::Date - toIntervalDay(87) AND date <= '2023-06-23'::Date - toIntervalDay(75) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(87) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(75) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pyasn1') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 19008 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pyasn1' AND date >= '2023-06-23'::Date - toIntervalDay(35) AND date <= '2023-06-23'::Date - toIntervalDay(13) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(35) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(13) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'colorama') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 8640 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'colorama' AND date >= '2023-06-23'::Date - toIntervalDay(29) AND date <= '2023-06-23'::Date - toIntervalDay(19) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(29) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(19) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'protobuf') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'protobuf' AND date >= '2023-06-23'::Date - toIntervalDay(36) AND date <= '2023-06-23'::Date - toIntervalDay(30) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(36) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(30) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'rsa') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 55296 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'rsa' AND date >= '2023-06-23'::Date - toIntervalDay(76) AND date <= '2023-06-23'::Date - toIntervalDay(12) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(76) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(12) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'attrs') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'attrs' AND date >= '2023-06-23'::Date - toIntervalDay(3) AND date <= '2023-06-23'::Date - toIntervalDay(1) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(3) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pytz') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 13824 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pytz' AND date >= '2023-06-23'::Date - toIntervalDay(19) AND date <= '2023-06-23'::Date - toIntervalDay(3) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(19) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(3) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pandas') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 3456 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pandas' AND date >= '2023-06-23'::Date - toIntervalDay(42) AND date <= '2023-06-23'::Date - toIntervalDay(38) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(42) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(38) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'markupsafe') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6048 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'markupsafe' AND date >= '2023-06-23'::Date - toIntervalDay(13) AND date <= '2023-06-23'::Date - toIntervalDay(6) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(13) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'jinja2') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6912 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'jinja2' AND date >= '2023-06-23'::Date - toIntervalDay(24) AND date <= '2023-06-23'::Date - toIntervalDay(16) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(24) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(16) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'cffi') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 36288 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'cffi' AND date >= '2023-06-23'::Date - toIntervalDay(74) AND date <= '2023-06-23'::Date - toIntervalDay(32) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(74) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(32) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pyjwt') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pyjwt' AND date >= '2023-06-23'::Date - toIntervalDay(63) AND date <= '2023-06-23'::Date - toIntervalDay(61) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(63) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(61) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pycparser') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 27648 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pycparser' AND date >= '2023-06-23'::Date - toIntervalDay(81) AND date <= '2023-06-23'::Date - toIntervalDay(49) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(81) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(49) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'aiobotocore') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'aiobotocore' AND date >= '2023-06-23'::Date - toIntervalDay(2) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(2) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 's3fs') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 's3fs' AND date >= '2023-06-23'::Date - toIntervalDay(51) AND date <= '2023-06-23'::Date - toIntervalDay(49) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(51) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(49) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'fsspec') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'fsspec' AND date >= '2023-06-23'::Date - toIntervalDay(6) AND date <= '2023-06-23'::Date - toIntervalDay(3) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(3) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'grpcio-status') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'grpcio-status' AND date >= '2023-06-23'::Date - toIntervalDay(44) AND date <= '2023-06-23'::Date - toIntervalDay(41) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(44) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(41) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'googleapis-common-protos') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 25920 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'googleapis-common-protos' AND date >= '2023-06-23'::Date - toIntervalDay(69) AND date <= '2023-06-23'::Date - toIntervalDay(39) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(69) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(39) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'docutils') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 32832 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'docutils' AND date >= '2023-06-23'::Date - toIntervalDay(72) AND date <= '2023-06-23'::Date - toIntervalDay(34) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(72) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(34) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'google-auth') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'google-auth' AND date >= '2023-06-23'::Date - toIntervalDay(87) AND date <= '2023-06-23'::Date - toIntervalDay(81) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(87) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(81) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'oauthlib') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 10368 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'oauthlib' AND date >= '2023-06-23'::Date - toIntervalDay(22) AND date <= '2023-06-23'::Date - toIntervalDay(10) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(22) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(10) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'tomli') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 47520 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'tomli' AND date >= '2023-06-23'::Date - toIntervalDay(69) AND date <= '2023-06-23'::Date - toIntervalDay(14) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(69) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(14) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'wrapt') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 22464 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'wrapt' AND date >= '2023-06-23'::Date - toIntervalDay(52) AND date <= '2023-06-23'::Date - toIntervalDay(26) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(52) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(26) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'cachetools') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'cachetools' AND date >= '2023-06-23'::Date - toIntervalDay(19) AND date <= '2023-06-23'::Date - toIntervalDay(17) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(19) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(17) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pyparsing') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 3456 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pyparsing' AND date >= '2023-06-23'::Date - toIntervalDay(57) AND date <= '2023-06-23'::Date - toIntervalDay(53) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(57) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(53) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'werkzeug') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'werkzeug' AND date >= '2023-06-23'::Date - toIntervalDay(19) AND date <= '2023-06-23'::Date - toIntervalDay(16) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(19) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(16) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'sqlalchemy') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 31968 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'sqlalchemy' AND date >= '2023-06-23'::Date - toIntervalDay(85) AND date <= '2023-06-23'::Date - toIntervalDay(48) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(85) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(48) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'requests-oauthlib') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 10368 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'requests-oauthlib' AND date >= '2023-06-23'::Date - toIntervalDay(81) AND date <= '2023-06-23'::Date - toIntervalDay(69) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(81) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(69) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'multidict') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 8640 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'multidict' AND date >= '2023-06-23'::Date - toIntervalDay(18) AND date <= '2023-06-23'::Date - toIntervalDay(8) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(18) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(8) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'yarl') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 12096 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'yarl' AND date >= '2023-06-23'::Date - toIntervalDay(51) AND date <= '2023-06-23'::Date - toIntervalDay(37) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(51) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(37) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pyarrow') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 34560 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pyarrow' AND date >= '2023-06-23'::Date - toIntervalDay(41) AND date <= '2023-06-23'::Date - toIntervalDay(1) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(41) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'jsonschema') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 3456 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'jsonschema' AND date >= '2023-06-23'::Date - toIntervalDay(5) AND date <= '2023-06-23'::Date - toIntervalDay(1) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(5) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'platformdirs') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 25056 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'platformdirs' AND date >= '2023-06-23'::Date - toIntervalDay(29) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(29) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'async-timeout') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 48384 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'async-timeout' AND date >= '2023-06-23'::Date - toIntervalDay(60) AND date <= '2023-06-23'::Date - toIntervalDay(4) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(60) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(4) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'aiohttp') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'aiohttp' AND date >= '2023-06-23'::Date - toIntervalDay(17) AND date <= '2023-06-23'::Date - toIntervalDay(11) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(17) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(11) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'isodate') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 29376 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'isodate' AND date >= '2023-06-23'::Date - toIntervalDay(60) AND date <= '2023-06-23'::Date - toIntervalDay(26) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(60) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(26) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'psutil') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 15552 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'psutil' AND date >= '2023-06-23'::Date - toIntervalDay(20) AND date <= '2023-06-23'::Date - toIntervalDay(2) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(20) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(2) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pydantic') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 15552 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pydantic' AND date >= '2023-06-23'::Date - toIntervalDay(24) AND date <= '2023-06-23'::Date - toIntervalDay(6) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(24) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(6) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'decorator') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 30240 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'decorator' AND date >= '2023-06-23'::Date - toIntervalDay(36) AND date <= '2023-06-23'::Date - toIntervalDay(1) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(36) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pyasn1-modules') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 3456 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pyasn1-modules' AND date >= '2023-06-23'::Date - toIntervalDay(25) AND date <= '2023-06-23'::Date - toIntervalDay(21) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(25) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(21) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'soupsieve') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 8640 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'soupsieve' AND date >= '2023-06-23'::Date - toIntervalDay(12) AND date <= '2023-06-23'::Date - toIntervalDay(2) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(12) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(2) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'flask') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 4320 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'flask' AND date >= '2023-06-23'::Date - toIntervalDay(22) AND date <= '2023-06-23'::Date - toIntervalDay(17) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(22) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(17) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pluggy') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 25056 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pluggy' AND date >= '2023-06-23'::Date - toIntervalDay(69) AND date <= '2023-06-23'::Date - toIntervalDay(40) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(69) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(40) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pytest') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 54432 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pytest' AND date >= '2023-06-23'::Date - toIntervalDay(72) AND date <= '2023-06-23'::Date - toIntervalDay(9) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(72) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(9) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'beautifulsoup4') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 10368 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'beautifulsoup4' AND date >= '2023-06-23'::Date - toIntervalDay(50) AND date <= '2023-06-23'::Date - toIntervalDay(38) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(50) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(38) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'lxml') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 27648 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'lxml' AND date >= '2023-06-23'::Date - toIntervalDay(56) AND date <= '2023-06-23'::Date - toIntervalDay(24) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(56) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(24) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'filelock') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'filelock' AND date >= '2023-06-23'::Date - toIntervalDay(11) AND date <= '2023-06-23'::Date - toIntervalDay(8) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(11) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(8) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'grpcio') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'grpcio' AND date >= '2023-06-23'::Date - toIntervalDay(32) AND date <= '2023-06-23'::Date - toIntervalDay(26) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(32) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(26) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'greenlet') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 5184 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'greenlet' AND date >= '2023-06-23'::Date - toIntervalDay(23) AND date <= '2023-06-23'::Date - toIntervalDay(17) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(23) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(17) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'frozenlist') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 1728 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'frozenlist' AND date >= '2023-06-23'::Date - toIntervalDay(54) AND date <= '2023-06-23'::Date - toIntervalDay(52) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(54) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(52) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'coverage') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'coverage' AND date >= '2023-06-23'::Date - toIntervalDay(5) AND date <= '2023-06-23'::Date - toIntervalDay(2) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(5) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(2) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'aiosignal') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 3456 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'aiosignal' AND date >= '2023-06-23'::Date - toIntervalDay(39) AND date <= '2023-06-23'::Date - toIntervalDay(35) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(39) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(35) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'azure-core') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 68256 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'azure-core' AND date >= '2023-06-23'::Date - toIntervalDay(79) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(79) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'scipy') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 44928 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'scipy' AND date >= '2023-06-23'::Date - toIntervalDay(55) AND date <= '2023-06-23'::Date - toIntervalDay(3) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(55) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(3) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pillow') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 35424 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pillow' AND date >= '2023-06-23'::Date - toIntervalDay(82) AND date <= '2023-06-23'::Date - toIntervalDay(41) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(82) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(41) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'tqdm') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 11232 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'tqdm' AND date >= '2023-06-23'::Date - toIntervalDay(21) AND date <= '2023-06-23'::Date - toIntervalDay(8) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(21) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(8) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pyrsistent') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 18144 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pyrsistent' AND date >= '2023-06-23'::Date - toIntervalDay(29) AND date <= '2023-06-23'::Date - toIntervalDay(8) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(29) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(8) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'virtualenv') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 53568 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'virtualenv' AND date >= '2023-06-23'::Date - toIntervalDay(72) AND date <= '2023-06-23'::Date - toIntervalDay(10) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(72) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(10) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'et-xmlfile') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 2592 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'et-xmlfile' AND date >= '2023-06-23'::Date - toIntervalDay(73) AND date <= '2023-06-23'::Date - toIntervalDay(70) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(73) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(70) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'openpyxl') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 56160 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'openpyxl' AND date >= '2023-06-23'::Date - toIntervalDay(72) AND date <= '2023-06-23'::Date - toIntervalDay(7) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(72) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(7) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'importlib-resources') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 10368 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'importlib-resources' AND date >= '2023-06-23'::Date - toIntervalDay(15) AND date <= '2023-06-23'::Date - toIntervalDay(3) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(15) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(3) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pyopenssl') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 26784 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pyopenssl' AND date >= '2023-06-23'::Date - toIntervalDay(43) AND date <= '2023-06-23'::Date - toIntervalDay(12) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(43) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(12) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'iniconfig') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 29376 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'iniconfig' AND date >= '2023-06-23'::Date - toIntervalDay(38) AND date <= '2023-06-23'::Date - toIntervalDay(4) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(38) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(4) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pygments') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 864 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pygments' AND date >= '2023-06-23'::Date - toIntervalDay(25) AND date <= '2023-06-23'::Date - toIntervalDay(24) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(25) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(24) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'chardet') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 53568 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'chardet' AND date >= '2023-06-23'::Date - toIntervalDay(76) AND date <= '2023-06-23'::Date - toIntervalDay(14) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(76) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(14) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'asn1crypto') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 44064 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'asn1crypto' AND date >= '2023-06-23'::Date - toIntervalDay(51) AND date <= '2023-06-23'::Date - toIntervalDay(0) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(51) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(0) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'itsdangerous') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 68256 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'itsdangerous' AND date >= '2023-06-23'::Date - toIntervalDay(81) AND date <= '2023-06-23'::Date - toIntervalDay(2) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(81) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(2) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'exceptiongroup') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 4320 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'exceptiongroup' AND date >= '2023-06-23'::Date - toIntervalDay(76) AND date <= '2023-06-23'::Date - toIntervalDay(71) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(76) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(71) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'websocket-client') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 36288 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'websocket-client' AND date >= '2023-06-23'::Date - toIntervalDay(83) AND date <= '2023-06-23'::Date - toIntervalDay(41) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(83) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(41) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'tabulate') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 50112 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'tabulate' AND date >= '2023-06-23'::Date - toIntervalDay(74) AND date <= '2023-06-23'::Date - toIntervalDay(16) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(74) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(16) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'google-api-python-client') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 12096 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'google-api-python-client' AND date >= '2023-06-23'::Date - toIntervalDay(75) AND date <= '2023-06-23'::Date - toIntervalDay(61) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(75) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(61) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'requests-toolbelt') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 12960 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'requests-toolbelt' AND date >= '2023-06-23'::Date - toIntervalDay(58) AND date <= '2023-06-23'::Date - toIntervalDay(43) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(58) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(43) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'google-cloud-core') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 43200 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'google-cloud-core' AND date >= '2023-06-23'::Date - toIntervalDay(51) AND date <= '2023-06-23'::Date - toIntervalDay(1) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(51) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(1) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'mypy-extensions') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 6912 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'mypy-extensions' AND date >= '2023-06-23'::Date - toIntervalDay(12) AND date <= '2023-06-23'::Date - toIntervalDay(4) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(12) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(4) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'pynacl') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 4320 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'pynacl' AND date >= '2023-06-23'::Date - toIntervalDay(66) AND date <= '2023-06-23'::Date - toIntervalDay(61) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(66) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(61) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'google-cloud-storage') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 39744 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'google-cloud-storage' AND date >= '2023-06-23'::Date - toIntervalDay(48) AND date <= '2023-06-23'::Date - toIntervalDay(2) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(48) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(2) GROUP BY period, major ORDER BY period ASC, major ASC;"
,"SELECT date as day, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major, count() AS count FROM pypi WHERE python != '' AND (project = 'psycopg2-binary') AND date >= '2023-06-23'::Date - toIntervalDay(90) GROUP BY day, major ORDER BY day ASC, major ASC"
,"SELECT toStartOfInterval(timestamp, INTERVAL 20736 second) as period, count() as count, splitByChar('.', python)[1] || '.' || splitByChar('.', python)[2] as major FROM pypi WHERE python != '' AND project = 'psycopg2-binary' AND date >= '2023-06-23'::Date - toIntervalDay(34) AND date <= '2023-06-23'::Date - toIntervalDay(10) AND timestamp >= '2023-06-23 08:33:59'::DateTime - toIntervalDay(34) AND timestamp <= '2023-06-23 08:33:59'::DateTime - toIntervalDay(10) GROUP BY period, major ORDER BY period ASC, major ASC;"
]; // end of queries

    </script>
</head>
<body>

<div class="header stick-left">
    <span class="nowrap themes"><span id="toggle-dark"></span><span id="toggle-light"></span></span>
    <h1>ClickHouse vs Snowflake - Downloads per Day by Python Version</h1>
    <a href="https://github.com/ClickHouse/clickhouse_vs_snowflake/">Methodology</a> | <a href="https://github.com/ClickHouse/clickhouse_vs_snowflake/">Reproduce and Validate the Results</a> | <a href="https://github.com/ClickHouse/clickhouse_vs_snowflake/">Add a System</a> | <a href="https://github.com/ClickHouse/clickhouse_vs_snowflake/">Report Mistake</a>
</div>

<table class="selectors-container stick-left">
    <tr>
        <th>System: </th>
        <td id="selectors_system">
            <a id="select-all-systems" class="selector selector-active">All</a>
        </td>
    </tr>
    <tr>
        <th>Type: </th>
        <td id="selectors_type">
            <a id="select-all-types" class="selector selector-active">All</a>
        </td>
    </tr>
    <tr>
        <th>Machine: </th>
        <td id="selectors_machine">
            <a id="select-all-machines" class="selector selector-active">All</a>
        </td>
    </tr>
    <tr>
        <th>Configuration: </th>
        <td id="selectors_config">
            <a id="select-all-configs" class="selector selector-active">All</a>
        </td>
    </tr>
    <tr>
        <th>Metric: </th>
        <td id="selectors_run">
            <a class="selector" id="selector-metric-cold">Cold Run</a>
            <a class="selector" id="selector-metric-hot">Hot Run</a>
            <a class="selector" id="selector-metric-size">Storage Size</a>
        </td>
    </tr>
</table>

<table class="stick-left comparison">
    <thead>
        <tr>
            <th class="summary-name">
                System &amp; Machine
            </th>
            <th colspan="2">
                Relative <span id="time-or-size">time</span> (lower is better)
            </th>
        </tr>
    </thead>
    <tbody id="summary">
    </tbody>
</table>

<div id="nothing-selected" class="stick-left">Nothing selected</div>

<div class="stick-left comparison">
    <h2>Detailed Comparison</h2>
</div>

<table id="details">
    <thead>
        <tr id="details_head">
        </tr>
    </thead>
    <tbody id="details_body">
    </tbody>
</table>

<script type="text/javascript">

const constant_time_add = 0.01;
const missing_result_penalty = 2;
const missing_result_time = 300;

let selectors = {
    "system": {},
    "type": {},
    "machine": {},
    "config": {},
    "metric": "hot",
    "queries": [],
};

let theme = 'light';

function setTheme(new_theme) {
    theme = new_theme;
    document.documentElement.setAttribute('data-theme', theme);
    window.localStorage.setItem('theme', theme);
    render();
}

document.getElementById('toggle-light').addEventListener('click', e => setTheme('light'));
document.getElementById('toggle-dark').addEventListener('click', e => setTheme('dark'));

let new_theme = window.localStorage.getItem('theme');
if (new_theme && new_theme != theme) {
    setTheme(new_theme);
}

/// Generate selectors

let systems = document.getElementById('selectors_system');
let types = document.getElementById('selectors_type');
let machines = document.getElementById('selectors_machine');
let configs = document.getElementById('selectors_config');

let unique_systems = [... new Set(data.map(elem => elem.system))];

function toggle(e, elem, selectors_map) {
    selectors_map[elem] = !selectors_map[elem];
    e.target.className = selectors_map[elem] ? 'selector selector-active' : 'selector';
    render();
    updateHistory();
}

function toggleAll(e, selectors_map) {
    const new_value = Object.keys(selectors_map).filter(k => selectors_map[k]).length * 2 < Object.keys(selectors_map).length;
    [...e.target.parentElement.querySelectorAll('a')].map(
        elem => { elem.className = new_value ? 'selector selector-active' : 'selector' });

    Object.keys(selectors_map).map(k => { selectors_map[k] = new_value });
    render();
    updateHistory();
}

unique_systems.map(elem => {
    let selector = document.createElement('a');
    selector.className = 'selector selector-active';
    selector.appendChild(document.createTextNode(elem));
    systems.appendChild(selector);
    if (!(elem in selectors.system)) { selectors.system[elem] = data.some(entry => entry.system == elem && !entry.hide); }
    selector.addEventListener('click', e => toggle(e, elem, selectors.system));

    /// Highlighting summary rows and table columns on hovering over the system selector.
    selector.addEventListener('mouseover', e => {
        [...document.querySelectorAll('.summary-row')].map(row => {
            row.className = row.dataset.system == elem ? 'summary-row summary-row-hilite' : 'summary-row' });
        [...document.querySelectorAll('.th-entry')].map(th => {
            th.className = th.dataset.system == elem ? 'th-entry th-entry-hilite' : 'th-entry' });
    });
    selector.addEventListener('mouseout', e => {
        [...document.querySelectorAll('.summary-row')].map(row => { row.className = 'summary-row' });
        [...document.querySelectorAll('.th-entry')].map(row => { row.className = 'th-entry' });
    });
});

[... new Set(data.map(elem => elem.tags).flat())].map(elem => {
    let selector = document.createElement('a');
    selector.className = 'selector selector-active';
    selector.appendChild(document.createTextNode(elem));
    types.appendChild(selector);
    if (!(elem in selectors.type)) { selectors.type[elem] = true; }
    selector.addEventListener('click', e => toggle(e, elem, selectors.type));
});

[... new Set(data.map(elem => elem.machine))].map(elem => {
    let selector = document.createElement('a');
    selector.className = 'selector selector-active';
    selector.appendChild(document.createTextNode(elem));
    machines.appendChild(selector);
    if (!(elem in selectors.machine)) { selectors.machine[elem] = true; }
    selector.addEventListener('click', e => toggle(e, elem, selectors.machine));
});

[... new Set(data.map(elem => elem.config))].sort(
    (a, b) => ((typeof(b) === 'number') - (typeof(a) === 'number')) || (a - b)).map(elem => {
    let selector = document.createElement('a');
    selector.className = 'selector selector-active';
    selector.appendChild(document.createTextNode(elem));
    configs.appendChild(selector);
    if (!(elem in selectors.config)) { selectors.config[elem] = true; }
    selector.addEventListener('click', e => toggle(e, elem, selectors.config));
});

document.getElementById('select-all-systems').addEventListener('click', e => toggleAll(e, selectors.system));
document.getElementById('select-all-types').addEventListener('click', e => toggleAll(e, selectors.type));
document.getElementById('select-all-machines').addEventListener('click', e => toggleAll(e, selectors.machine));
document.getElementById('select-all-configs').addEventListener('click', e => toggleAll(e, selectors.config));

[...document.getElementById('selectors_run').querySelectorAll('a')].map(elem => elem.addEventListener('click', e => {
    [...e.target.parentElement.querySelectorAll('a')].map(elem => { elem.className = elem == e.target ? 'selector selector-active' : 'selector' });
}));

document.getElementById('selector-metric-cold').addEventListener('click', e => { selectors.metric = 'cold'; render(); updateHistory(); });
document.getElementById('selector-metric-hot').addEventListener('click', e => { selectors.metric = 'hot'; render(); updateHistory(); });
document.getElementById('selector-metric-size').addEventListener('click', e => { selectors.metric = 'size'; render(); updateHistory(); });

selectors.queries = [...data[0].result.keys()].map(k => true);

function updateSelectors() {
    [...systems.childNodes].map(elem => { elem.className = selectors.system[elem.innerText] ? 'selector selector-active' : 'selector' });
    [...types.childNodes].map(elem => { elem.className = selectors.type[elem.innerText] ? 'selector selector-active' : 'selector' });
    [...machines.childNodes].map(elem => { elem.className = selectors.machine[elem.innerText] ? 'selector selector-active' : 'selector' });
    [...configs.childNodes].map(elem => { elem.className = selectors.config[elem.innerText] ? 'selector selector-active' : 'selector' });

    [...document.getElementById('selectors_run').querySelectorAll('a')].map(elem => {
        elem.className = elem.id == 'selector-metric-' + selectors.metric ? 'selector selector-active' : 'selector' });

    [...document.querySelectorAll('.query-checkbox')].map((elem, i) => { elem.checked = selectors.queries[i] });
}

function clearElement(elem)
{
    while (elem.firstChild) {
        elem.removeChild(elem.lastChild);
    }
}

function selectRun(timings) {
    return selectors.metric == 'cold' ? timings[0] : (timings.some(timing => timing !== null) ? Math.min(...timings.slice(1).filter(timing => timing !== null)) : null)
}

function addNote(text) {
    let note = document.createElement('sup');
    note.className = 'note';
    note.appendChild(document.createTextNode(''));

    let tooltip = document.createElement('span');
    tooltip.className = 'tooltip tooltip-result';
    tooltip.appendChild(document.createTextNode(text));

    note.appendChild(tooltip);
    return note;
}

function renderSummary(filtered_data) {
    let table = document.getElementById('summary');
    clearElement(table);

    /// Generate summary

    /// The algorithm: for each of the queries,
    /// - if there is a result - take query duration, add 10 ms, and divide it to the corresponding value from the baseline,
    /// - if there is no result - take the worse query duration across all query runs for this system and multiply by 2.
    /// Take geometric mean across the queries.

    let summary = {};

    const num_queries = filtered_data[0].result.length;

    const baseline_data = [...filtered_data[0].result.keys()].map(query_num =>
        [...Array(5).keys()].map(run_num =>
            Math.min(...filtered_data.filter(elem => !elem.fake).map(elem => elem.result[query_num][run_num]).filter(x => x))));

    const min_data_size = Math.min(...filtered_data.map(elem => elem.data_size).filter(x => x));

    let summaries;
    if (selectors.metric == 'size') {
        summaries = filtered_data.map(elem => elem.data_size / min_data_size);
        document.getElementById('time-or-size').innerText = 'size';
    } else {
        summaries = filtered_data.map(elem => {
            const fallback_timing = missing_result_penalty * Math.max(missing_result_time, ...elem.result.map(timings => selectRun(timings)));

            let accumulator = 0;
            let used_queries = 0;

            const no_queries_selected = selectors.queries.filter(x => x).length == 0;

            for (let i = 0; i < num_queries; ++i) {
                if (no_queries_selected || selectors.queries[i]) {
                    const curr_timing = selectRun(elem.result[i]) ?? fallback_timing;
                    const baseline_timing = selectRun(baseline_data[i]);
                    const ratio = (constant_time_add + curr_timing) / (constant_time_add + baseline_timing);
                    accumulator += Math.log(ratio);
                    ++used_queries;
                }
            }

            return Math.exp(accumulator / used_queries);
        });
        document.getElementById('time-or-size').innerText = 'time';
    }

    const sorted_indices = [...summaries.keys()].sort((a, b) => summaries[a] - summaries[b]);
    const max_ratio = summaries[sorted_indices[sorted_indices.length - 1]];

    sorted_indices.map(idx => {
        const elem = filtered_data[idx];

        if (selectors.metric == 'size' && elem.data_size === null) { return; }

        let tr = document.createElement('tr');
        tr.className = 'summary-row';

        tr.dataset.system = elem.system;

        let td_name = document.createElement('td');
        td_name.className = 'summary-name';

        if (!elem.fake) {
            let link = document.createElement('a');
            link.appendChild(document.createTextNode(`${elem.system} (${Number.isInteger(elem.config) && elem.config > 1 ? elem.config + '': ''}${elem.machine} - ${elem.config})`));
            link.href = "https://github.com/ClickHouse/clickhouse_vs_snowflake/blob/main/" + elem.source;
            td_name.appendChild(link);
        } else {
            td_name.appendChild(document.createTextNode(elem.system));
        }

        if (elem.comment) { td_name.appendChild(addNote(elem.comment)); }
        td_name.appendChild(document.createTextNode(': '));

        const ratio = summaries[idx];
        const percentage = summaries[idx] / max_ratio * 100;

        let td_number = document.createElement('td');
        td_number.className = 'summary-number';

        const text = selectors.metric == 'size' ? `${(elem.data_size / 1024 / 1024 / 1024).toFixed(2)} GiB (${ratio.toFixed(2)})`
            : `${ratio.toFixed(2)}`;

        td_number.appendChild(document.createTextNode(text));

        let td_bar = document.createElement('td');
        td_bar.className = 'summary-bar-cell';

        let bar = document.createElement('div');

        bar.className = `summary-bar`;
        bar.style.width = `${percentage}%`;

        td_bar.appendChild(bar);

        tr.appendChild(td_name);
        tr.appendChild(td_bar);
        tr.appendChild(td_number);
        table.appendChild(tr);
    });

    return [sorted_indices, baseline_data];
}

function colorize(elem, ratio) {
    let [r, g, b] = [0, 0, 0];

    /// ratio less than 1 - green
    /// ratio from 1 to 2 - green to yellow
    /// ratio from 2 to 10 - yellow to red
    /// ratio from 10 to 1000 to infinity - red to brown to black

    /// Note: we are using RGB space without proper gamma correction. Read more: https://www.handprint.com/HP/WCL/color1.html

    if (ratio !== null) {
        if (ratio < 1) {
            r = 232;
            g = 255;
            b = 232;
        } else if (ratio <= 1) {
            g = 255;
        } else if (ratio <= 2) {
            g = 255;
            r = (ratio - 1) * 255;
        } else if (ratio <= 10) {
            g = (10 - ratio) / 8 * 255;
            r = 255;
        } else {
            r = (1 - ((ratio - 10) / ((ratio - 10) + 1000))) * 255;
        }
    }

    if (document.documentElement.getAttribute('data-theme') == 'dark') {
        r /= 1.5;
        g /= 1.5;
        b /= 1.5;
    }

    elem.style.backgroundColor = `rgb(${r}, ${g}, ${b})`;
    if (ratio === null || ratio > 10) {
        /// This will look better on dark backgrounds
        elem.style.color = 'white';
    } else {
        elem.style.color = 'black';
    }

    /// The best result is highlighted
    if (ratio == 1) {
        elem.style.fontWeight = 'bold';
    }
}

function render() {
    let details_head = document.getElementById('details_head');
    let details_body = document.getElementById('details_body');

    clearElement(details_head);
    clearElement(details_body);

    let filtered_data = data.filter(elem =>
        selectors.system[elem.system] &&
        selectors.machine[elem.machine] &&
        selectors.config[elem.config] &&
        elem.tags.filter(type => selectors.type[type]).length > 0);

    let nothing_selected_elem = document.getElementById('nothing-selected');
    if (filtered_data.length == 0) {
        nothing_selected_elem.style.display = 'block';
        [...document.querySelectorAll('.comparison')].map(e => e.style.display = 'none');
        return;
    }
    nothing_selected_elem.style.display = 'none';
    [...document.querySelectorAll('.comparison')].map(e => e.style.display = 'block');

    if (selectors.metric == 'size') {
        filtered_data = [...filtered_data];
    }

    let [sorted_indices, baseline_data] = renderSummary(filtered_data);
    sorted_indices = sorted_indices.filter(idx => !filtered_data[idx].fake);

    /// Generate details

    /// Global checkbox
    {
        let th_checkbox = document.createElement('th');
        let checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.checked = true;
        checkbox.addEventListener('change', e => {
            [...document.querySelectorAll('.query-checkbox')].map(elem => { elem.checked = e.target.checked });
            selectors.queries.map((_, i) => { selectors.queries[i] = e.target.checked });
            renderSummary(filtered_data);
            updateHistory();
        });
        th_checkbox.appendChild(checkbox);
        details_head.appendChild(th_checkbox);
        details_head.appendChild(document.createElement('th'));
    }

    /// Table header
    sorted_indices.map(idx => {
        const elem = filtered_data[idx];
        let th = document.createElement('th');
        th.appendChild(document.createTextNode(`${elem.system}\n(${Number.isInteger(elem.config) && elem.config > 1 ? elem.config + '': ''}${elem.machine} - \n ${elem.config})`));
        th.className = 'th-entry';
        th.dataset.system = elem.system;
        details_head.appendChild(th);
    });



    /// Data sizes
    {
        let tr = document.createElement('tr');
        tr.className = 'shadow';

        let td_title = document.createElement('td');
        td_title.colSpan = 2;
        td_title.appendChild(document.createTextNode('Data size: '));
        tr.appendChild(td_title);

        sorted_indices.map(idx => {
            const curr_size = filtered_data[idx].data_size;
            const baseline_size = Math.min(...filtered_data.map(elem => elem.data_size).filter(x => x));
            const ratio = curr_size !== null ? curr_size / baseline_size : null;

            let td = document.createElement('td');
            td.appendChild(document.createTextNode(curr_size !== null ? `${(curr_size / 1024 / 1024 / 1024).toFixed(2)} GiB (${ratio.toFixed(2)})` : ''));

            colorize(td, ratio);
            tr.appendChild(td);
        });

        details_body.appendChild(tr);
    }

    /// Query runtimes
    const num_queries = filtered_data[0].result.length;

    for (let query_num = 0; query_num < num_queries; ++query_num) {
        let tr = document.createElement('tr');
        tr.className = 'shadow';

        let td_checkbox = document.createElement('td');
        let checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.className = 'query-checkbox';
        checkbox.checked = selectors.queries[query_num];
        checkbox.addEventListener('change', e => {
            selectors.queries[query_num] = e.target.checked;
            renderSummary(filtered_data);
            updateHistory();
        });
        td_checkbox.appendChild(checkbox);
        tr.appendChild(td_checkbox);

        let td_query_num = document.createElement('td');
        td_query_num.className = 'note';
        td_query_num.appendChild(document.createTextNode(`Q${query_num}. `));

        let tooltip = document.createElement('span');
        tooltip.className = 'tooltip tooltip-query';
        tooltip.appendChild(document.createTextNode(`Query ${query_num}: ${queries[query_num]}`));
        td_query_num.appendChild(tooltip);

        tr.appendChild(td_query_num);

        sorted_indices.map(idx => {
            const curr_timing = selectRun(filtered_data[idx].result[query_num]);
            const baseline_timing = selectRun(baseline_data[query_num]);
            const ratio = curr_timing !== null ? (constant_time_add + curr_timing) / (constant_time_add + baseline_timing) : null;

            let td = document.createElement('td');
            td.appendChild(document.createTextNode(curr_timing !== null ? `${curr_timing.toFixed(2)}s (${ratio.toFixed(2)})` : ''));

            colorize(td, ratio);
            tr.appendChild(td);
        });

        details_body.appendChild(tr);
    }
}

function updateHistory() {
    history.pushState(selectors, '',
        window.location.pathname + (window.location.search || '') + '#' + btoa(JSON.stringify(selectors)));
}

window.onpopstate = function(event) {
    if (!event.state) { return; }
    selectors = event.state;
    render();
    updateSelectors();
};

if (window.location.hash) {
    try {
        selectors = JSON.parse(atob(window.location.hash.substring(1)));
    } catch {}
}

render();
updateSelectors();

</script>
</body>
</html>
